import{_ as y,o as l,c,a as o,t as p,I as N,T as U,M as P,B as A,r as m,b as a,F as v,d as I,w as O,e as R,f as M,g as x,n as B,h as S,i as T,v as D,A as G,U as j,j as E,R as ae,O as le,k as de,l as Q,m as q,p as K,q as ce,s as Y,u as ue,x as me,y as W,z as _e,C as he}from"./InputImageComponent-75b3b2c0.js";const pe={props:["id","name","value","checked","label"],name:"CheckboxComponent"},ge={class:"form-check form-switch mt-3"},fe={class:"checkbox-inline"},we=["id","name","checked"],be=["for"];function ke(e,t,n,r,s,i){return l(),c("div",ge,[o("label",fe,[o("input",{class:"form-check-input",id:n.id,type:"checkbox",name:n.name,checked:n.checked,onInput:t[0]||(t[0]=_=>e.$emit("update:checked",_.target.checked))},null,40,we),o("label",{class:"form-check-label",for:n.id},p(n.label),9,be)])])}const L=y(pe,[["render",ke]]);const ve={name:"FeedbackComponent",components:{InputComponent:N,TextAreaComponent:U,ModalComponent:P,CheckboxComponent:L,ButtonComponent:A},data(){return{name:"",email:"",text:"",i_agree:!1,disabledSubmit:!0,errors:{name:null,email:null,text:null}}},props:{feedback_url:String},methods:{checkDisableSubmit(){let e=this;$.each(["name","email","message"],function(t,n){e.errors[n]=null}),this.disabledSubmit=!this.name.length||!this.email.length||!this.text.length||!this.i_agree},feedback(){let e=this;window.addLoader(),axios.post(this.feedback_url,{_token:window.tokenField,name:this.name,email:this.email,text:this.text,i_agree:this.i_agree}).then(function(t){window.showMessage(t.data.message),e.name="",e.email="",e.text="",window.removeLoader()}).catch(function(t){$.each(t.response.data.errors,(n,r)=>{e.errors[n]=r[0]}),window.removeLoader()})}}};function Ce(e,t,n,r,s,i){const _=m("InputComponent"),u=m("TextAreaComponent"),f=m("CheckboxComponent"),C=m("ButtonComponent");return l(),c(v,null,[a(_,{label:"Ваше имя",type:"text",name:"name",placeholder:"Введите ваше имя",value:s.name,error:s.errors.name,"onUpdate:value":t[0]||(t[0]=b=>s.name=b),onChange:i.checkDisableSubmit},null,8,["value","error","onChange"]),a(_,{label:"E-mail",type:"text",name:"email",placeholder:"Введите ваш E-Mail",error:s.errors.email,value:s.email,"onUpdate:value":t[1]||(t[1]=b=>s.email=b),onChange:i.checkDisableSubmit},null,8,["error","value","onChange"]),a(u,{class:"mt-2",label:"Ваше сообщение",name:"message",placeholder:"Введите ваше сообщение",min:"10",max:"3000",value:s.text,"onUpdate:value":t[2]||(t[2]=b=>s.text=b),error:s.errors.text,onChange:i.checkDisableSubmit},null,8,["value","error","onChange"]),a(f,{name:"i_agree",checked:s.i_agree,label:"Даю согласие на обработку персональных данных","onUpdate:checked":t[3]||(t[3]=b=>s.i_agree=b),onChange:i.checkDisableSubmit},null,8,["checked","onChange"]),a(C,{class_name:"btn btn-primary mt-3 pull-right",text:"Отправить",disabled:s.disabledSubmit,onClick:i.feedback},null,8,["disabled","onClick"])],64)}const ye=y(ve,[["render",Ce],["__scopeId","data-v-5f7c5b48"]]),xe={name:"MessageComponent",components:{ModalComponent:P},data(){return{message:""}}},Se={class:"text-center p-4"};function Oe(e,t,n,r,s,i){const _=m("ModalComponent");return l(),I(_,{id:"message-modal",head:"Сообщение"},{default:O(()=>[o("h4",Se,p(s.message),1)]),_:1})}const Ie=y(xe,[["render",Oe]]),Me={name:"ForgotPasswordComponent"},Te={class:"w-100 text-center mb-2"},$e=o("a",{href:"#","data-bs-toggle":"modal","data-bs-target":"#restore-password-modal","data-bs-dismiss":"modal","data-dismiss":"modal"},"Забыли свой пароль?",-1),Pe=[$e];function Ae(e,t,n,r,s,i){return l(),c("div",Te,Pe)}const X=y(Me,[["render",Ae]]),Be={name:"LoginComponent",components:{ModalComponent:P,ButtonComponent:A,CheckboxComponent:L,InputComponent:N,ForgotPasswordComponent:X},created(){const e=this;$.mask.definitions.n="[7-8]",$(document).ready(function(){$("#login-modal input[name=phone]").mask(window.phoneMask).on("blur keypress keyup change",function(){e.phone=$(this).val(),e.checkDisableSubmit(),e.errors.phone=null,e.errors.password=null})})},props:{login_url:String},data(){return{rememberMe:!0,phone:"",password:"",disabledSubmit:!0,errors:{phone:null,password:null}}},emits:["loggedIn"],methods:{checkDisableSubmit(){this.disabledSubmit=this.phone.match(window.phoneRegExp)===null||!this.password.length},onSubmit(){let e=this;this.disabledSubmit=!0,window.addLoader(),axios.post(this.login_url,{_token:window.tokenField,phone:this.phone,password:this.password,remember:this.rememberMe}).then(function(t){$("#login-modal").modal("hide"),e.$emit("loggedIn",t.data.id),window.removeLoader()}).catch(function(t){$.each(t.response.data.errors,(n,r)=>{e.errors[n]=r[0]}),window.removeLoader()})}}};function De(e,t,n,r,s,i){const _=m("InputComponent"),u=m("ButtonComponent"),f=m("CheckboxComponent"),C=m("ForgotPasswordComponent"),b=m("ModalComponent");return l(),I(b,{id:"login-modal",head:"Вход/регистрация",onKeyup:R(i.onSubmit,["enter"])},{default:O(()=>[a(_,{label:"Телефон",icon:"",type:"text",name:"phone",placeholder:"+_(___)___-__-__",value:s.phone,error:s.errors.phone},null,8,["value","error"]),a(_,{label:"Пароль",icon:"icon-eye",type:"password",name:"password",placeholder:"Пароль",value:s.password,error:s.errors.password,"onUpdate:value":t[0]||(t[0]=g=>s.password=g),onKeyup:i.checkDisableSubmit},null,8,["value","error","onKeyup"]),a(u,{id:"enter",class_name:"btn btn-primary",disabled:s.disabledSubmit,icon:"icon-enter3",text:"Войти",onClick:i.onSubmit},null,8,["disabled","onClick"]),a(u,{id:"register",class_name:"btn btn-secondary",target:"#register-modal",disabled:!1,dismiss:!0,icon:"icon-user-plus",text:"Зарегистрироваться"}),a(f,{id:"remember_me",name:"remember",checked:s.rememberMe,label:"Запомнить меня","onUpdate:checked":t[1]||(t[1]=g=>s.rememberMe=g)},null,8,["checked"]),a(C)]),_:1},8,["onKeyup"])}const Fe=y(Be,[["render",De]]),Re={name:"GetCodeAgainComponent",props:{timer:Number}},Ne={id:"get-code-again",class:"w-100 text-center mb-2"};function Ue(e,t,n,r,s,i){return l(),c("div",Ne,[M("Получить код повторно можно через "),o("span",null,p(n.timer),1),M(" секунд")])}const ee=y(Re,[["render",Ue]]),je={name:"RegisterComponent",components:{ModalComponent:P,ButtonComponent:A,CheckboxComponent:L,InputComponent:N,ForgotPasswordComponent:X,GetCodeAgainComponent:ee},created(){const e=this;$.mask.definitions.n="[7-8]",$(document).ready(function(){const t=$("#register-modal");t.find("input[name=phone]").mask(window.phoneMask).on("blur keypress keyup change",function(){e.phone=$(this).val(),e.enableRegisterButtons(),e.errors.phone=null,e.errors.password=null}),t.find("input[name=code]").mask(codeMask).on("blur keypress keyup change",function(){e.code=$(this).val(),e.enableRegisterButtons(),e.errors.code=null})})},props:{register_url:String,get_code_url:String,account_change_url:String},data(){return{iAgree:!0,phone:"",password:"",passwordConfirmation:"",code:"",getCodeAgainVisible:!1,getCodeAgainTimer:0,disabledSubmit:!0,disableGetCode:!0,errors:{phone:null,password:null,code:null}}},methods:{runTimer(){this.getCodeAgainVisible=!0,this.getCodeAgainTimer=60;let e=setInterval(()=>{this.getCodeAgainTimer?this.getCodeAgainTimer--:(this.disableGetCode=!1,this.getCodeAgainVisible=!1,clearInterval(e))},1e3);this.disableGetCode=!0},enableRegisterButtons(){this.phone.match(window.phoneRegExp)!==null&&this.password.length&&this.passwordConfirmation.length&&this.iAgree?(this.disableGetCode=this.getCodeAgainTimer>0,this.disabledSubmit=!this.code.match(window.codeRegExp)||!this.iAgree):(this.disableGetCode=!0,this.disabledSubmit=!0)},getCode(){if(!this.getCodeAgainTimer){let e=this;this.disableGetCode=!0,axios.post(this.get_code_url,{_token:window.tokenField,phone:this.phone,password:this.password,password_confirmation:this.passwordConfirmation,i_agree:this.iAgree}).then(function(t){e.runTimer(),window.showMessage(t.data.message)}).catch(function(t){var n=["phone","password","password_confirmation","code"],r=!1;$.each(t.response.data.errors,(s,i)=>{e.errors[s]=i[0],n.indexOf(s)!==-1&&(r=!0)}),r||window.showMessage(t.response.data.message)})}},onSubmit(e){let t=this;this.disabledSubmit=!0,window.addLoader(),axios.post(this.register_url,{_token:window.tokenField,phone:this.phone,password:this.password,password_confirmation:this.passwordConfirmation,code:this.code,i_agree:this.iAgree}).then(function(n){window.showMessage(n.data.message),$("#register-modal").modal("hide"),window.removeLoader(),setTimeout(function(){window.location.href=t.account_change_url},3e3),$("#message-modal").modal("show").on("hidden.bs.modal",()=>{window.location.href=t.account_change_url})}).catch(function(n){$.each(n.response.data.errors,(r,s)=>{t.errors[r]=s[0],window.removeLoader()})})}}};function Ee(e,t,n,r,s,i){const _=m("InputComponent"),u=m("ButtonComponent"),f=m("get-code-again-component"),C=m("CheckboxComponent"),b=m("ForgotPasswordComponent"),g=m("ModalComponent");return l(),I(g,{id:"register-modal",head:"Зарегистрироваться",onKeyup:R(i.onSubmit,["enter"])},{default:O(()=>[a(_,{label:"Телефон",icon:"",type:"text",name:"phone",placeholder:"+_(___)___-__-__",value:s.phone,error:s.errors.phone},null,8,["value","error"]),a(_,{label:"Пароль",icon:"icon-eye",type:"password",name:"password",placeholder:"Пароль",value:s.password,error:s.errors.password,"onUpdate:value":t[0]||(t[0]=d=>s.password=d),onKeyup:i.enableRegisterButtons},null,8,["value","error","onKeyup"]),a(_,{label:"Подтверждение пароля",icon:"icon-eye",type:"password",name:"password_confirmation",placeholder:"Подтверждение пароля",value:s.passwordConfirmation,error:s.errors.password,"onUpdate:value":t[1]||(t[1]=d=>s.passwordConfirmation=d),onKeyup:i.enableRegisterButtons},null,8,["value","error","onKeyup"]),a(_,{label:"Код",type:"text",name:"code",placeholder:"__-__-__",value:s.code,error:s.errors.code,onKeyup:i.enableRegisterButtons},null,8,["value","error","onKeyup"]),a(u,{id:"get-register-code",class_name:"btn btn-primary",disabled:s.disableGetCode,icon:"icon-key",text:"Получить код",onClick:i.getCode},null,8,["disabled","onClick"]),s.getCodeAgainVisible?(l(),I(f,{key:0,timer:s.getCodeAgainTimer},null,8,["timer"])):x("",!0),a(u,{id:"register",class_name:"btn btn-primary",disabled:s.disabledSubmit,icon:"icon-reset",text:"Зарегистрироваться",onClick:i.onSubmit},null,8,["disabled","onClick"]),a(C,{id:"i_agree",name:"i_agree",label:"Даю согласие на обработку персональных данных",checked:s.iAgree,"onUpdate:checked":t[2]||(t[2]=d=>s.iAgree=d),onChange:i.enableRegisterButtons},null,8,["checked","onChange"]),a(b)]),_:1},8,["onKeyup"])}const te=y(je,[["render",Ee]]),Le={name:"RestorePasswordComponent",components:{ModalComponent:P,ButtonComponent:A,InputComponent:N},props:{reset_pass_url:String},created(){const e=this;$.mask.definitions.n="[7-8]",$(document).ready(function(){$("#restore-password-modal input[name=phone]").mask(window.phoneMask).on("blur keypress keyup change",function(){e.phone=$(this).val(),e.disabledSubmit=e.phone.match(window.phoneRegExp)===null,e.errors.phone=null})})},data(){return{phone:"",disabledSubmit:!0,errors:{phone:null}}},methods:{onSubmit(e){let t=this;this.disabledSubmit=!0,window.addLoader(),axios.post(this.reset_pass_url,{_token:window.tokenField,phone:this.phone}).then(function(n){window.showMessage(n.data.message),$("#restore-password-modal").modal("hide"),window.removeLoader()}).catch(function(n){$.each(n.response.data.errors,(r,s)=>{t.errors[r]=s[0]}),window.removeLoader()})}}};function ze(e,t,n,r,s,i){const _=m("InputComponent"),u=m("ButtonComponent"),f=m("ModalComponent");return l(),I(f,{id:"restore-password-modal",head:"Восстановление пароля",onKeyup:R(i.onSubmit,["enter"])},{default:O(()=>[a(_,{label:"Телефон",type:"text",name:"phone",placeholder:"+_(___)___-__-__",value:s.phone,error:s.errors.phone},null,8,["value","error"]),a(u,{id:"reset-button",class_name:"btn btn-primary",disabled:s.disabledSubmit,icon:"icon-user-plus",text:"Восстановить пароль",onClick:i.onSubmit},null,8,["disabled","onClick"]),a(u,{id:"back-to-login",class_name:"btn btn-secondary",toggle:"modal",target:"#login-modal",disabled:!1,dismiss:!0,icon:"icon-enter3",text:"Войти"})]),_:1},8,["onKeyup"])}const He=y(Le,[["render",ze]]),Ke={name:"LogoComponent",props:{image:String}},Ye=["src"];function Ge(e,t,n,r,s,i){return l(),c("img",{class:"logo",src:n.image},null,8,Ye)}const Ve=y(Ke,[["render",Ge]]),Je={name:"TopMenuItemComponent",props:{is_active:Boolean,add_class:String,url:String,name:String}},Ze=["href"];function qe(e,t,n,r,s,i){return l(),c("li",{class:B("nav-item "+n.add_class+" "+(n.is_active?"active":""))},[o("a",{class:"nav-link",href:n.url},p(n.name),9,Ze)],2)}const Qe=y(Je,[["render",qe]]),We={name:"AccountIconComponent",props:{icon:String}},Xe=["src"];function et(e,t,n,r,s,i){return l(),c("img",{class:"account-icon",src:n.icon},null,8,Xe)}const tt=y(We,[["render",et]]),nt={name:"TopLineComponent",created(){this.authCheck=!isNaN(parseInt(this.auth)),this.userId=parseInt(this.user_id),this.mainMenu=JSON.parse(this.main_menu),this.ordersStatuses=JSON.parse(this.order_statuses),this.authCheck&&(this.getNewsMessages(),this.getNews(),this.listenEvents()),this.onRoot=parseInt(this.on_root)},data(){return{authCheck:!1,hasMessages:!1,onRoot:Number,userId:0,mainMenu:{},newsMessages:[],newsSubscriptions:[],newsPerformers:[],newsRemovedPerformers:[],newsStatusOrders:[],newsIncentives:[],newsTickets:[],newsAnswers:[],ordersStatuses:[]}},methods:{loggedIn(e){this.userId=e,this.authCheck=!0,this.getNewsMessages(),this.getNews(),this.listenEvents()},getNewsMessages(){let e=this;axios.get(this.get_unread_messages_url).then(function(t){t.data.unread.length&&(e.newsMessages=t.data.unread,e.hasMessages=!0,e.setEmitter("my-messages",!0))})},getNews(){let e=this;axios.get(this.get_news_url).then(function(t){t.data.news_subscriptions.length&&(e.newsSubscriptions=t.data.news_subscriptions,e.setEmitter("my-subscriptions",!0),e.hasMessages=!0),t.data.news_performers.length&&(e.newsPerformers=t.data.news_performers,e.setEmitter("my-orders",!0),e.hasMessages=!0),t.data.news_removed_performers.length&&(e.newsRemovedPerformers=t.data.news_removed_performers,e.setEmitter("my-help",!0),e.hasMessages=!0),t.data.news_status_orders.length&&(e.newsStatusOrders=t.data.news_status_orders,e.setEmitter("my-orders",!0),e.hasMessages=!0),t.data.news_incentive.length&&(e.newsIncentives=t.data.news_incentive,e.setEmitter("incentives",!0),e.hasMessages=!0),t.data.news_tickets.length&&(e.newsTickets=t.data.news_tickets,e.setEmitter("my-tickets",!0),e.hasMessages=!0),t.data.news_answers.length&&(e.newsAnswers=t.data.news_answers,e.setEmitter("my-tickets",!0),e.hasMessages=!0),e.bellAlert(e.hasMessages)})},listenEvents(){let e=this,t=!1,n=!1;window.Echo.private("incentive_"+this.userId).listen(".incentive",r=>{r.notice==="remove_incentive"?(n=e.findIncentive(r.incentive.id),n!==!1&&(e.newsIncentives.splice(n,1),e.setEmitter("incentives",e.newsIncentives.length),e.setHasMessages())):r.notice==="new_incentive"&&(e.newsIncentives.push(r),e.setEmitter("incentives",!0),e.hasMessages=!0,e.bellAlert(!0))}),window.Echo.private("notice_"+this.userId).listen(".notice",r=>{switch(r.notice){case"new_message":if(n=this.findOrder(e.newsMessages,r.order.id),n!==!1){let s=e.newsMessages[n].count;s++,e.newsMessages[n].count=s}else e.newsMessages.push({order:r.order,count:1});e.setEmitter("my-messages",!0),t=!0,e.hasMessages=!0;break;case"new_order_in_subscription":e.newsSubscriptions.push(r),e.setEmitter("my-subscriptions",!0),t=!0,e.hasMessages=!0;break;case"new_performer":e.newsPerformers.push(r),e.setEmitter("my-orders",!0),e.hasMessages=!0;break;case"new_order_status":e.newsStatusOrders.push(r),e.setEmitter("my-orders",!0),e.hasMessages=!0;break;case"remove_performer":e.newsRemovedPerformers.push(r),e.setEmitter("my-help",!0),t=!0,e.hasMessages=!0;break}e.bellAlert(t)}),window.Echo.channel("order_event").listen(".order",r=>{r.notice==="remove_order"&&(n=e.findOrder(e.newsMessages,r.order.id),n!==!1&&(e.newsMessages.splice(n,1),e.setEmitter("my-messages",e.newsMessages.length)),n=e.findOrder(e.newsSubscriptions,r.order.id),n!==!1&&(e.newsSubscriptions.splice(n,1),e.setEmitter("my-subscriptions",e.newsSubscriptions.length)),n=e.findOrder(e.newsPerformers,r.order.id),n!==!1&&(e.newsPerformers.splice(n,1),e.setEmitter("my-orders",e.newsPerformers.length)),n=e.findOrder(e.newsStatusOrders,r.order.id),n!==!1&&(e.newsStatusOrders.splice(n,1),e.setEmitter("my-orders",e.newsStatusOrders.length)),n=e.findOrder(e.newsRemovedPerformers,r.order.id),n!==!1&&(e.newsRemovedPerformers.splice(n,1),e.setEmitter("my-help",e.newsRemovedPerformers.length)),e.setHasMessages())}),window.Echo.channel("ticket_"+this.userId).listen(".ticket",r=>{n=e.findTicket(r.ticket.id),r.notice==="change_item"&&(n!==!1&&e.newsTickets[k].subject!==r.ticket.subject&&(e.newsTickets[k]=r.ticket),r.ticket.status&&!r.ticket.read_owner?(e.newsTickets.push(r.ticket),e.bellAlert(!0)):n&&(r.ticket.status&&r.ticket.read_owner||r.notice==="del_item")&&e.newsTickets.splice(n,1)),e.setEmitter("my-tickets",e.newsTickets.length||e.newsAnswers.length),e.setHasMessages()}),window.Echo.channel("answer_"+this.userId).listen(".answer",r=>{r.notice==="new_item"?(e.newsAnswers.push(r.answer),e.bellAlert(!0)):(r.notice==="change_item"&&r.answer.read_owner||r.notice==="del_item")&&(n=e.findAnswer(r.answer.id),n!==!1&&e.newsAnswers.splice(n,1)),e.setEmitter("my-tickets",e.newsTickets.length||e.newsAnswers.length),e.setHasMessages()}),window.emitter.on("read-order",r=>{n=e.findOrder(e.newsSubscriptions,r),n!==!1&&(e.newsSubscriptions.splice(n,1),e.setEmitter("my-subscriptions",e.newsSubscriptions.length),e.setHasMessages())}),window.emitter.on("read-message",r=>{n=e.findOrder(e.newsMessages,r),n!==!1&&(e.newsMessages.splice(n,1),e.setEmitter("my-messages",e.newsMessages.length),e.setHasMessages())}),window.emitter.on("read-unread-by-my-orders",r=>{e.newsPerformers=[],e.newsStatusOrders=[],e.setEmitter("my-orders",!1)}),window.emitter.on("read-unread-by-my-help",r=>{e.newsPerformers=[],e.newsRemovedPerformers=[],e.setEmitter("my-help",!1)})},bellAlert(e){e&&window.bellRinging($("#right-button-block .fa.fa-bell-o"))},setEmitter(e,t){window.emitter.emit(e,t)},setHasMessages(){this.hasMessages=this.newsSubscriptions.length||this.newsPerformers.length||this.newsRemovedPerformers.length||this.newsStatusOrders.length||this.newsIncentives.length||this.newsMessages.length},findOrder(e,t){return window.findSomething(e,t)},findIncentive(e){return window.findSomething(this.newsIncentives,e)},findTicket(e){return window.findSomething(this.newsTickets,e)},findAnswer(e){return window.findSomething(this.newsAnswers,e)},cropContent(e,t){return window.cropContent(e,t)}},components:{LogoComponent:Ve,LoginComponent:Fe,RegisterComponent:te,RestorePasswordComponent:He,TopMenuItemComponent:Qe,ButtonComponent:A,AccountIconComponent:tt},props:{auth:String,user_id:String,on_root:String,home_url:String,login_url:String,register_url:String,get_code_url:String,reset_pass_url:String,logo_image:String,logo_text_image:String,main_menu:String,account_icon:String,new_order_url:String,account_change_url:String,messages_url:String,orders_url:String,active_main_menu:String,get_unread_messages_url:String,chat_url:String,get_news_url:String,my_orders_url:String,my_help_url:String,incentives_url:String,my_tickets_url:String,order_statuses:String}},st={key:0},ot={id:"top-line",class:"w-100 d-flex align-items-center justify-content-between"},rt=["href"],it={class:"logo-block d-none d-lg-flex align-items-center justify-content-between"},at=["src"],lt={id:"main-nav",class:"main-nav navbar navbar-expand-lg navbar-light"},dt=o("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbar-main-nav","aria-controls":"navbar-main-nav","aria-expanded":"false","aria-label":"Переключатель навигации"},[o("span",{class:"navbar-toggler-icon"})],-1),ct={class:"collapse navbar-collapse",id:"navbar-main-nav"},ut={class:"navbar-nav"},mt={class:"d-block d-lg-none"},_t=["href"],ht={class:"d-block d-lg-none"},pt=["href"],gt={key:1,id:"login-href",href:"#","data-bs-toggle":"modal","data-bs-target":"#login-modal"},ft=["data-bs-toggle"],wt={class:"fa fa-bell-o"},bt={key:0,class:"dot"},kt={class:"dropdown-menu","aria-labelledby":"navbar-dropdown-messages"},vt={id:"dropdown"},Ct={class:"counter"},yt=o("br",null,null,-1),xt=["href"],St=o("hr",null,null,-1),Ot=["href"],It=o("br",null,null,-1),Mt=o("hr",null,null,-1),Tt=["href"],$t=o("br",null,null,-1),Pt=o("hr",null,null,-1),At=["href"],Bt=o("br",null,null,-1),Dt=o("hr",null,null,-1),Ft=["href"],Rt=o("br",null,null,-1),Nt=o("hr",null,null,-1),Ut=["href"],jt=o("br",null,null,-1),Et=o("hr",null,null,-1),Lt=o("br",null,null,-1),zt=["href"],Ht=o("hr",null,null,-1),Kt=["href"],Yt=o("br",null,null,-1),Gt=o("hr",null,null,-1),Vt=["href"],Jt=o("i",{class:"icon-add-to-list"},null,-1),Zt=[Jt],qt=["href"],Qt=o("i",{class:"icon-map"},null,-1),Wt=[Qt],Xt=["href"];function en(e,t,n,r,s,i){const _=m("LoginComponent"),u=m("RegisterComponent"),f=m("RestorePasswordComponent"),C=m("logo-component"),b=m("top-menu-item-component"),g=m("AccountIconComponent"),d=m("ButtonComponent");return l(),c(v,null,[s.authCheck?x("",!0):(l(),c("div",st,[a(_,{login_url:n.login_url,onLoggedIn:i.loggedIn},null,8,["login_url","onLoggedIn"]),a(u,{register_url:n.register_url,get_code_url:n.get_code_url,account_change_url:n.account_change_url},null,8,["register_url","get_code_url","account_change_url"]),a(f,{reset_pass_url:n.reset_pass_url},null,8,["reset_pass_url"])])),o("div",ot,[o("a",{class:"d-none d-lg-block",href:n.home_url},[o("div",it,[a(C,{image:n.logo_image},null,8,["image"]),o("img",{class:"logo-text",src:n.logo_text_image},null,8,at)])],8,rt),o("nav",lt,[dt,o("div",ct,[o("ul",ut,[(l(!0),c(v,null,S(this.mainMenu,h=>(l(),I(b,{key:h.key,is_active:n.active_main_menu===h.key,add_class:"",url:h.url,name:h.name},null,8,["is_active","url","name"]))),128)),s.authCheck?(l(),I(b,{is_active:!1,key:"new_order",add_class:"d-block d-lg-none",url:n.new_order_url,name:"Создать заявку"},null,8,["url"])):x("",!0),s.authCheck?(l(),I(b,{is_active:!1,key:"orders",add_class:"d-block d-lg-none",url:n.orders_url,name:"Оказать помощь"},null,8,["url"])):x("",!0)])])]),o("div",mt,[o("a",{href:n.home_url},[a(C,{image:n.logo_image},null,8,["image"])],8,_t)]),o("div",ht,[s.authCheck?(l(),c("a",{key:0,id:"account-href",href:n.account_change_url},[a(g,{icon:n.account_icon},null,8,["icon"])],8,pt)):(l(),c("a",gt,[a(g,{icon:n.account_icon},null,8,["icon"])]))]),o("div",{id:"right-button-block",class:B("buttons-block d-none d-lg-flex align-items-center justify-content-"+(s.authCheck?"between":"end")+(s.onRoot?" on-root":""))},[s.authCheck?(l(),c("a",{key:0,id:"navbar-dropdown-messages",class:B("ms-2 me-2"+(s.hasMessages?" dropdown-toggle":"")),role:"button","data-bs-toggle":s.hasMessages?"dropdown":"","aria-expanded":"false"},[o("i",wt,[s.hasMessages?(l(),c("span",bt)):x("",!0)])],10,ft)):x("",!0),T(o("div",kt,[o("ul",vt,[(l(!0),c(v,null,S(s.newsMessages,(h,w)=>(l(),c("li",{key:w},[M(" Новых сообщений: "),o("span",Ct,p(h.count),1),yt,o("a",{href:n.chat_url+"?id="+h.order.id},"в чате по заявке «"+p(h.order.name)+"»",9,xt),St]))),128)),(l(!0),c(v,null,S(s.newsSubscriptions,(h,w)=>(l(),c("li",{key:w},[o("a",{href:n.orders_url+"?id="+h.order.id},"Новая заяка «"+p(h.order.name)+"» от:",9,Ot),It,M(" "+p(h.order.user.name+" "+h.order.user.family)+" ",1),Mt]))),128)),(l(!0),c(v,null,S(s.newsPerformers,(h,w)=>(l(),c("li",{key:w},[o("a",{href:n.my_orders_url},"Новый исполнитель у заявки «"+p(h.order.name)+"»:",9,Tt),$t,M(" "+p(h.user.name+" "+h.user.family)+" ",1),Pt]))),128)),(l(!0),c(v,null,S(s.newsRemovedPerformers,(h,w)=>(l(),c("li",{key:w},[o("a",{href:n.my_help_url},"Вам было отказано в участии",8,At),Bt,M(" в выполнении заяки «"+p(h.order.name)+"» ",1),Dt]))),128)),(l(!0),c(v,null,S(s.newsIncentives,(h,w)=>(l(),c("li",{key:w},[o("a",{href:n.incentives_url+"?id="+h.action.id},"У вас новая награда:",8,Ft),Rt,M(" Акция «"+p(h.action.name)+"» ",1),Nt]))),128)),(l(!0),c(v,null,S(s.newsAnswers,(h,w)=>(l(),c("li",{key:w},[o("a",{href:n.my_tickets_url+"?id="+h.ticket.id},"У вас новый ответ на обращение:",8,Ut),jt,M(" «"+p(i.cropContent(h.ticket.subject,70))+"» ",1),Et]))),128)),(l(!0),c(v,null,S(s.newsTickets,(h,w)=>(l(),c("li",{key:w},[M(" Запрос на тему «"+p(i.cropContent(h.subject,70))+"» закрыт",1),Lt,o("a",{href:n.my_tickets_url},"К списку запросов »",8,zt),Ht]))),128)),(l(!0),c(v,null,S(s.newsStatusOrders,(h,w)=>(l(),c("li",{key:w},[o("a",{href:n.my_orders_url},"Новый статус у заявки «"+p(h.order.name)+"»",9,Kt),M(":"),Yt,M(" «"+p(s.ordersStatuses[h.order.status])+"» ",1),Gt]))),128))])],512),[[D,s.authCheck&&s.hasMessages]]),s.authCheck&&!s.onRoot?(l(),c("a",{key:1,class:"ms-2 me-2",href:n.new_order_url},Zt,8,Vt)):x("",!0),s.authCheck&&!s.onRoot?(l(),c("a",{key:2,class:"ms-2 me-2",href:n.orders_url},Wt,8,qt)):x("",!0),s.authCheck?(l(),c("a",{key:3,href:n.account_change_url},[a(d,{id:"account-button",class_name:"btn btn-secondary ms-3",icon:"icon-user-lock",text:"Личный кабинет"})],8,Xt)):(l(),I(d,{key:4,id:"login-button",class_name:"btn btn-secondary",toggle:"modal",target:"#login-modal",icon:"icon-user-lock",text:"Вход/регистрация"}))],2)])],64)}const tn=y(nt,[["render",en]]),nn={name:"LeftMenuComponent",components:{AvatarComponent:G,UserNameComponent:j,ModalComponent:P,ButtonComponent:A},created(){this.userObj=JSON.parse(this.user),this.leftMenu=JSON.parse(this.left_menu);let e=this;$.each(this.leftMenu,function(t,n){window.emitter.on(n.id,r=>{e.newsFlags[n.id]=r})})},data(){return{userObj:{},leftMenu:Array,saveAvatarFlag:!1,errors:{avatar:null},newsFlags:{"my-messages":!1,"my-subscriptions":!1,"my-orders":!1,"my-help":!1,incentives:!1,"my-tickets":!1}}},props:{user:String,left_menu:String,logout_url:String,change_avatar_url:String|NaN,active_left_menu:String}},sn={class:"col-12 col-lg-4"},on={class:"rounded-block tall left-menu"},rn={id:"avatar-block"},an={class:"w-100"},ln={class:"d-flex align-items-center justify-content-start"},dn={class:"fs-lg-6 fs-sm-7 ms-3"},cn=o("br",null,null,-1),un={key:0,class:"error"},mn={class:"menu"},_n=["href"],hn={key:0,class:"dot"},pn={class:"bottom-block"},gn={class:"d-flex align-items-center justify-content-left"},fn=["href"],wn=o("i",{class:"icon-exit3 me-1"},null,-1);function bn(e,t,n,r,s,i){const _=m("AvatarComponent"),u=m("UserNameComponent");return l(),c("div",sn,[o("div",on,[o("div",rn,[o("div",an,[o("div",ln,[a(_,{small:!1,avatar_image:s.userObj.avatar,avatar_props:s.userObj.avatar_props,avatar_error:s.errors.avatar,change_avatar_url:n.change_avatar_url},null,8,["avatar_image","avatar_props","avatar_error","change_avatar_url"]),o("div",dn,[M("Добро пожаловать,"),cn,a(u,{user:s.userObj},null,8,["user"]),M("!")]),s.errors.avatar?(l(),c("div",un,p(s.errors.avatar),1)):x("",!0)])])]),o("ul",mn,[(l(!0),c(v,null,S(s.leftMenu,f=>(l(),c("li",{key:f.id,class:B(f.key===n.active_left_menu?"active":"")},[o("a",{href:f.url},[o("i",{class:B(f.icon)},null,2),M(p(f.name),1)],8,_n),s.newsFlags[f.id]?(l(),c("span",hn)):x("",!0)],2))),128))]),o("div",pn,[o("div",gn,[o("a",{href:n.logout_url},[wn,M("Выйти")],8,fn)])])])])}const kn=y(nn,[["render",bn]]),vn={extends:te,name:"AccountComponent",components:{InputComponent:N,TextAreaComponent:U,ModalComponent:P,ButtonComponent:A,GetCodeAgainComponent:ee},created(){let e=this,t=JSON.parse(this.user);this.name=t.name,this.family=t.family,this.born=t.born,this.phone=t.phone,this.email=t.email,this.infoAbout=t.info_about,this.mailNotice=t.mail_notice,e.checkDisableSubmit(),$.mask.definitions.c="[1-2]",$(document).ready(function(){const n=$("#change-phone-modal"),r=n.find("input[name=phone]"),s=n.find("input[name=code]"),i=$("#account-block"),_=i.find("input[name=born]");r.mask(window.phoneMask).on("blur keypress keyup change",function(){e.phone=$(this).val(),e.disabledGetCode=e.phone.match(window.phoneRegExp)===null,e.enableChangePhoneModalButton(),e.errors.phone=null}),s.mask(window.codeMask).on("blur keypress keyup change",function(){e.code=$(this).val(),e.enableChangePhoneModalButton(),e.errors.code=null}),_.mask(window.bornMask).on("blur keypress keyup change",function(){e.born=$(this).val(),e.checkDisableSubmit()})})},data(){return{name:"",family:"",born:String,phone:String,code:"",changingPhone:"",email:String,oldPassword:"",password:"",passwordConfirmation:"",infoAbout:String,mailNotice:Boolean,disabledSubmit:!0,disabledGetCode:!0,disabledChangePhone:!0,errors:{name:null,family:null,born:null,phone:null,code:null,email:null,info_about:null,old_password:null,password:null}}},props:{user:String,edit_account_url:String,get_code_url:String,change_phone_url:String,change_password_url:String},methods:{checkDisableSubmit(){let e=this;$.each(["name","family","born","email"],function(t,n){e.errors[n]=null}),this.disabledSubmit=!(this.name&&this.name.length&&this.family&&this.family.length&&this.born.match(window.bornRegExp))},enableChangePhoneModalButton(){this.disabledChangePhone=this.phone.match(window.phoneRegExp)===null||this.code.match(window.codeRegExp)===null},getCode(){if(!this.getCodeAgainTimer){let e=this;this.disabledGetCode=!0,axios.post(this.get_code_url,{_token:window.tokenField,phone:this.phone}).then(function(t){e.runTimer(),window.showMessage(t.data.message)}).catch(function(t){$.each(t.response.data.errors,(n,r)=>{e.errors[n]=r[0]})})}},changePhone(){let e=this;this.disabledChangePhone=!0,window.addLoader(),axios.post(this.change_phone_url,{_token:window.tokenField,phone:this.phone,code:this.code}).then(function(t){$("#change-phone-modal").modal("hide"),window.showMessage(t.data.message),window.removeLoader()}).catch(function(t){$.each(t.response.data.errors,(n,r)=>{e.errors[n]=r[0]}),window.removeLoader()})},changePassword(){let e=this;axios.post(this.change_password_url,{_token:window.tokenField,old_password:e.oldPassword,password:e.password,password_confirmation:e.passwordConfirmation}).then(function(t){$("#change-password-modal").modal("hide"),window.showMessage(t.data.message)}).catch(function(t){$.each(t.response.data.errors,(n,r)=>{e.errors[n]=r[0]})})},onSubmit(){let e=this;this.disabledSubmit=!0,window.addLoader(),axios.post(this.edit_account_url,{_token:window.tokenField,name:e.name,family:e.family,born:e.born,email:e.email,info_about:e.infoAbout,mail_notice:e.mailNotice}).then(function(t){window.removeLoader(),window.showMessage(t.data.message)}).catch(function(t){$.each(t.response.data.errors,(n,r)=>{e.errors[n]=r[0]}),window.removeLoader()})}}},Cn={class:"col-12 col-lg-8"},yn={class:"rounded-block tall"},xn={class:"row"},Sn={id:"account-block",class:"col-12 col-lg-6"},On={id:"phone-number",class:"mt-3 mb-0 text-center"},In={class:"col-12 col-lg-6"},Mn={class:"w-100 text-end mt-4"};function Tn(e,t,n,r,s,i){const _=m("InputComponent"),u=m("ButtonComponent"),f=m("GetCodeAgainComponent"),C=m("ModalComponent"),b=m("CheckboxComponent"),g=m("TextAreaComponent");return l(),c(v,null,[a(C,{id:"change-phone-modal",head:"Изменить телефон",onKeyup:R(i.changePhone,["enter"])},{default:O(()=>[a(_,{label:"Телефон",type:"text",name:"phone",placeholder:"+_(___)___-__-__",error:s.errors.phone},null,8,["error"]),a(_,{label:"Код",type:"text",name:"code",placeholder:"__-__-__",error:s.errors.code},null,8,["error"]),a(u,{id:"get-register-code",class_name:"btn btn-primary",disabled:s.disabledGetCode,icon:"icon-key",text:"Получить код",onClick:i.getCode},null,8,["disabled","onClick"]),e.getCodeAgainVisible?(l(),I(f,{key:0,timer:e.getCodeAgainTimer},null,8,["timer"])):x("",!0),a(u,{id:"change-phone-button",class_name:"btn btn-primary",disabled:s.disabledChangePhone,icon:"icon-reset",text:"Изменить телефон",onClick:i.changePhone},null,8,["disabled","onClick"])]),_:1},8,["onKeyup"]),a(C,{id:"change-password-modal",head:"Изменить пароль",onKeyup:R(i.changePassword,["enter"])},{default:O(()=>[a(_,{label:"Старый пароль",icon:"icon-eye",type:"password",name:"old_password",placeholder:"Пароль",error:s.errors.old_password,value:s.oldPassword,"onUpdate:value":t[0]||(t[0]=d=>s.oldPassword=d),onChange:t[1]||(t[1]=d=>s.errors.old_password=null)},null,8,["error","value"]),a(_,{label:"Новый пароль",icon:"icon-eye",type:"password",name:"password",placeholder:"Новый пароль",error:s.errors.password,value:s.password,"onUpdate:value":t[2]||(t[2]=d=>s.password=d),onChange:t[3]||(t[3]=d=>s.errors.password=null)},null,8,["error","value"]),a(_,{label:"Подтверждение пароля",icon:"icon-eye",type:"password",name:"password_confirmation",placeholder:"Подтверждение пароля",error:s.errors.password,value:s.passwordConfirmation,"onUpdate:value":t[4]||(t[4]=d=>s.passwordConfirmation=d),onChange:t[5]||(t[5]=d=>s.errors.password=null)},null,8,["error","value"]),a(u,{id:"change-password-button",class_name:"btn btn-primary",disabled:!(s.oldPassword.length&&s.password.length&&s.passwordConfirmation.length),icon:"icon-file-locked2",text:"Изменить пароль",onClick:i.changePassword},null,8,["disabled","onClick"])]),_:1},8,["onKeyup"]),o("div",Cn,[o("div",yn,[o("div",xn,[o("div",Sn,[a(_,{label:"Ваше имя",type:"text",name:"name",placeholder:"Введите ваше имя",value:s.name,error:s.errors.name,"onUpdate:value":t[6]||(t[6]=d=>s.name=d),onChange:i.checkDisableSubmit},null,8,["value","error","onChange"]),a(_,{label:"Ваша фамилия",type:"text",name:"family",placeholder:"Введите вашу фамилию",value:s.family,error:s.errors.family,"onUpdate:value":t[7]||(t[7]=d=>s.family=d),onChange:i.checkDisableSubmit},null,8,["value","error","onChange"]),a(_,{label:"Дата рождения",type:"text",name:"born",placeholder:"__-__-____",value:s.born,error:s.errors.born},null,8,["value","error"]),a(_,{label:"E-mail",type:"text",name:"email",placeholder:"Введите ваш E-Mail",error:s.errors.email,value:s.email,"onUpdate:value":t[8]||(t[8]=d=>s.email=d),onChange:i.checkDisableSubmit},null,8,["error","value","onChange"]),a(b,{name:"mail_notice",checked:s.mailNotice,label:"Получать оповещения по E-mail","onUpdate:checked":t[9]||(t[9]=d=>s.mailNotice=d)},null,8,["checked"]),o("p",On,"Телефон: "+p(s.phone),1),a(u,{class_name:"btn btn-secondary w-100 mt-3",target:"#change-phone-modal",text:"Изменить телефон"}),a(u,{class_name:"btn btn-secondary w-100 mt-2 mb-3",target:"#change-password-modal",text:"Изменить пароль"})]),o("div",In,[a(g,{id:"info-about",label:"Информация о себе",name:"info_about",placeholder:"",value:s.infoAbout,"onUpdate:value":t[10]||(t[10]=d=>s.infoAbout=d),error:s.errors.info_about,onChange:t[11]||(t[11]=d=>s.errors.info_about=null)},null,8,["value","error"]),o("div",Mn,[a(u,{id:"account-save",class_name:"btn btn-primary",text:"Сохранить",disabled:s.disabledSubmit,onClick:i.onSubmit},null,8,["disabled","onClick"])])])])])])],64)}const $n=y(vn,[["render",Tn]]),Pn={name:"TabsComponent",props:{tabs:Object,show_counters:Boolean},created(){this.activeTab=Object.keys(this.tabs)[0]},data(){return{activeTab:String}},methods:{changeTab(e){this.activeTab=e,this.$emit("changeTab",e)}}},An={class:"top-submenu row"},Bn=["id","onClick"],Dn={key:0};function Fn(e,t,n,r,s,i){return l(),c("div",An,[(l(!0),c(v,null,S(n.tabs,(_,u)=>(l(),c("div",{class:B("col-lg-3 col-md-6 col-sm-12"+(u===s.activeTab?" active":"")),key:u},[o("a",{id:"top-submenu-"+u,href:"#",onClick:f=>i.changeTab(u)},p(_.name),9,Bn),n.show_counters?(l(),c("sup",Dn,p(_.counter),1)):x("",!0)],2))),128))])}const Rn=y(Pn,[["render",Fn]]),Nn={name:"NoDataComponent"},Un={class:"w-100 h-100 d-flex justify-content-center align-items-center"},jn=o("h4",{class:"no-data-block text-uppercase text-secondary mt-4"},"Нет данных",-1),En=[jn];function Ln(e,t,n,r,s,i){return l(),c("div",Un,En)}const z=y(Nn,[["render",Ln]]),zn={name:"PaginatorComponent",props:{links:Array,tab_key:String},emits:["paginate"]},Hn={class:"paginator"},Kn={key:0,class:"w-100 d-flex justify-content-start mt-2 ps-4"},Yn=["onClick"],Gn={key:0,class:"icon-arrow-left7"},Vn={key:1,class:"icon-arrow-right7"},Jn={key:2};function Zn(e,t,n,r,s,i){return l(),c("div",Hn,[n.links.length>3?(l(),c("div",Kn,[(l(!0),c(v,null,S(n.links,(_,u)=>(l(),c("div",{class:B("paginate-button "+(_.active?"active":"")),key:"paginate-"+u,onClick:f=>e.$emit("paginate",{key:n.tab_key,url:_.url})},[~_.label.indexOf("Пред")?(l(),c("i",Gn)):~_.label.indexOf("След")?(l(),c("i",Vn)):(l(),c("span",Jn,p(_.label),1))],10,Yn))),128))])):x("",!0)])}const V=y(zn,[["render",Zn]]),qn={name:"OrdersTabsComponent",components:{NoDataComponent:z,UserPropertiesComponent:E,ButtonComponent:A,PaginatorComponent:V},props:{user_id:Number,tabs:Object,active_tab:String,edit_order_url:String,chat_url:String,orders_map_url:String,subscription_mode:Boolean,chat_mode:Boolean},emits:["closingOrder","resumingOrder","deletingOrder","performers","removingPerformer","changePage","respond","unsubscribe"],methods:{cropContent(e,t){return window.cropContent(e,t)},paginate(e){this.$emit("changePage",e)}}},Qn=["id"],Wn={key:0,class:"h-100 d-flex flex-column justify-content-between"},Xn={class:"row"},es={class:"item-in-list text-center p-3"},ts=o("hr",{class:"mt-1 mb-1"},null,-1),ns={class:"h6 fw-bold"},ss={class:"h6 text-secondary"},os=o("hr",{class:"mt-1 mb-1"},null,-1),rs={class:"text-secondary fs-6 mb-1"},is={key:0,class:"w-100 text-center mb-1"},as=o("i",{class:"icon-map orange me-1"},null,-1),ls={class:"text-secondary"},ds=["href"],cs=["onClick"],us=o("span",{class:"text-secondary me-1"},[o("small",null,"Исполнителей:")],-1),ms=o("i",{title:"Участники",class:"orange icon-users4 me-1"},null,-1),_s={class:"text-secondary"},hs={key:2,class:"w-100 d-flex justify-content-center"},ps={key:3},gs=["href"],fs={key:6,class:"w-100 d-flex justify-content-center mt-1"},ws={class:"w-50 m-auto"},bs=["href"];function ks(e,t,n,r,s,i){const _=m("UserPropertiesComponent"),u=m("ButtonComponent"),f=m("PaginatorComponent"),C=m("NoDataComponent");return l(!0),c(v,null,S(n.tabs,(b,g)=>T((l(),c("div",{id:"tab-"+g,key:g},[b.orders.length?(l(),c("div",Wn,[o("div",Xn,[(l(!0),c(v,null,S(b.orders,d=>(l(),c("div",{class:"col-lg-6 col-sm-12 mb-1",key:d.id},[o("div",es,[a(_,{user:d.user,small:!0,use_rating:!0,allow_change_rating:!1},null,8,["user"]),ts,o("div",ns,"«"+p(i.cropContent(d.name,30))+"»",1),o("div",ss,p(d.order_type.name),1),os,o("p",rs,[o("small",null,p(i.cropContent(d.address,40)),1)]),n.subscription_mode?(l(),c("div",is,[as,o("span",ls,[o("small",null,[o("a",{href:n.orders_map_url+"?id="+d.id,title:"Перейти на карту"},"Посмотреть на карте",8,ds)])])])):(l(),c("div",{key:1,class:"w-100 text-center mb-1",role:"button",onClick:h=>e.$emit("performers",{order:d})},[us,ms,o("span",_s,[o("small",null,p(d.performers.length),1)])],8,cs)),n.subscription_mode?(l(),c("div",hs,[a(u,{class:"btn btn-primary w-50 m-auto me-1",text:"Откликнуться",onClick:h=>e.$emit("respond",d)},null,8,["onClick"]),a(u,{class:"btn btn-primary w-50 m-auto",text:"Отписаться",onClick:h=>e.$emit("unsubscribe",d.read_subscriptions)},null,8,["onClick"])])):n.chat_mode?(l(),c("div",ps,[o("a",{href:n.chat_url+"?id="+d.id},[a(u,{class:"btn btn-primary w-100 m-auto",text:"Перейти в чат"})],8,gs)])):x("",!0),n.user_id===d.user_id&&d.status===1&&!n.chat_mode?(l(),I(u,{key:4,class:"btn btn-primary w-100 m-auto",text:"Завершить",onClick:h=>e.$emit("closingOrder",d)},null,8,["onClick"])):n.user_id===d.user_id&&d.status===0?(l(),I(u,{key:5,class:"btn btn-primary w-100 m-auto",text:"Возобновить",onClick:h=>e.$emit("resumingOrder",d.id)},null,8,["onClick"])):n.user_id===d.user_id&&(d.status===2||d.status===3)?(l(),c("div",fs,[a(u,{class:"btn btn-primary w-50 m-auto me-1",text:"Удалить",onClick:h=>e.$emit("deletingOrder",{key:g,id:d.id})},null,8,["onClick"]),o("div",ws,[o("a",{href:n.edit_order_url+"?id="+d.id},[a(u,{class:"btn btn-primary w-100",text:"Редактировать"})],8,bs)])])):x("",!0)])]))),128))]),a(f,{links:b.links,tab_key:g,onPaginate:i.paginate},null,8,["links","tab_key","onPaginate"])])):(l(),I(C,{key:1}))],8,Qn)),[[D,g===n.active_tab]])),128)}const ne=y(qn,[["render",ks]]),vs={name:"ModalPairButtonsComponent",components:{ButtonComponent:A}},Cs={class:"modal-footer justify-content-center"};function ys(e,t,n,r,s,i){const _=m("ButtonComponent");return l(),c("div",Cs,[a(_,{class:"btn btn-primary w-25 mt-3","data-bs-dismiss":"modal",text:"Нет"}),a(_,{class:"btn btn-primary w-25 mt-3",text:"Да","data-bs-dismiss":"modal",onClick:t[0]||(t[0]=u=>e.$emit("clickYes"))})])}const J=y(vs,[["render",ys]]),xs={name:"MyOrdersListComponent",components:{RatingLineComponent:ae,ModalComponent:P,TabsComponent:Rn,OrdersTabsComponent:ne,NoDataComponent:z,ModalPairButtonsComponent:J,UserPropertiesComponent:E,ButtonComponent:A},created(){let e=this,t;this.userId=parseInt(this.user_id),this.activeTab=Object.keys(this.tabs)[0],this.ordersUrls=JSON.parse(this.orders_urls),this.refreshOrders(),window.emitter.on("tab-changed",n=>{this.activeTab=n}),window.Echo.private("notice_"+this.userId).listen(".notice",n=>{t=e.getOrderIndex("active",n.order.id),n.notice==="new_order_status"?e.refreshOrders():(n.notice==="new_performer"||n.notice==="remove_performer")&&t!==null&&(e.tabs.active.orders[t].performers=n.performers),axios.get(e.read_unread_by_my_orders).then(function(r){window.emitter.emit("read-unread-by-my-orders")})}),window.Echo.channel("order_event").listen(".order",n=>{if(n.notice==="remove_order"&&n.user.id!==e.userId){let r=e.tabs.active?"active":"open";t=e.getOrderIndex(r,n.order.id),t!==null&&e.refreshOrders()}})},data(){return{userId:Number,closingOrderUser:null,tabs:{active:{name:"В работе",counter:0,orders:Array,links:[]},open:{name:"Открыты",counter:0,orders:Array,links:[]},approving:{name:"На модерации",counter:0,orders:Array,links:[]},archive:{name:"Архив",counter:0,orders:Array,links:[]}},ordersUrls:[],closingOrderId:0,resumingOrderId:0,deletingOrderId:0,deletingOrderTab:"",removingPerformerId:0,removingPerformerOrderId:0,showRefuseButton:!0,performers:[],rating:0,activeTab:String}},props:{user_id:String,head:String,orders_urls:String,read_unread_by_my_orders:String,close_order_url:String,resume_order_url:String,delete_order_url:String,remove_performer_url:String,set_rating_url:String,edit_order_url:String,resume_image:String},methods:{getOrders(e,t,n,r){let s=this;axios.get(e).then(function(i){s.tabs[t].counter=i.data.orders.total,s.tabs[t].orders=i.data.orders.data,s.tabs[t].links=i.data.orders.links,n&&window.emitter.emit("refresh-complete"),r&&r()})},changePage(e){let t=$("#tab-"+this.activeTab);t.fadeOut(()=>{this.getOrders(e.url,e.key,!1,()=>{t.fadeIn()})})},changeTab(e){window.changeTab(this.activeTab,e)},closeOrder(e){this.closingOrderId=e.id,this.closingOrderUser=e.performers[0],$("#order-closing-confirm-modal").modal("show")},closingOrder(){let e=this;axios.post(e.close_order_url,{_token:window.tokenField,id:e.closingOrderId}).then(function(t){e.refreshOrders(),$("#order-closed-modal").modal("show")})},resumeOrder(e){this.resumingOrderId=e,$("#order-resume-confirm-modal").modal("show")},resumingOrder(){let e=this;axios.post(e.resume_order_url,{_token:window.tokenField,id:e.resumingOrderId}).then(function(t){e.refreshOrders(),$("#order-resumed-modal").modal("show")})},deleteOrder(e){this.deletingOrderId=e.id,this.deletingOrderTab=e.key,$("#order-delete-confirm-modal").modal("show")},deletingOrder(){let e=this;axios.post(e.delete_order_url,{_token:window.tokenField,id:e.deletingOrderId}).then(function(t){e.refreshOrders()})},getPerformers(e){console.log(e),this.performers=e.order.performers,this.removingPerformerOrderId=e.order.id,this.showRefuseButton=e.order.status===1,$("#order-performers-modal").modal("show")},removePerformer(e){this.removingPerformerId=e,$("#order-removing-performer-confirm-modal").modal("show")},removingPerformer(){let e=this;axios.post(e.remove_performer_url,{_token:window.tokenField,order_id:e.removingPerformerOrderId,user_id:e.removingPerformerId}).then(function(t){let n=e.getOrderIndex("active",e.removingPerformerOrderId);for(let r=0;r<e.tabs.active.orders[n].performers.length;r++)if(e.tabs.active.orders[n].performers[r].id===e.removingPerformerId){e.tabs.active.orders[n].performers.splice(r,1);break}$("#order-performers-modal").modal("hide"),window.showMessage(t.data.message)})},setRating(){let e=this;axios.post(e.set_rating_url,{_token:window.tokenField,order_id:e.closingOrderId,rating:e.rating})},refreshOrders(){let e=this;$.each(e.tabs,function(t){e.getOrders(e.ordersUrls[t],t,!0,!1)})},getOrderIndex(e,t){let n=null;for(let r=0;r<this.tabs[e].orders.length;r++)if(this.tabs[e].orders[r].id===t){n=r;break}return n}}},Ss=o("h4",{class:"text-center"},"Вы действительно хотите завершить эту заявку?",-1),Os=o("h4",{class:"text-center"},"Вы действительно хотите возобновить эту заявку?",-1),Is=["src"],Ms=o("h4",{class:"text-center"},"Вы действительно хотите удалить эту заявку?",-1),Ts={key:0,class:"table table-striped"},$s={class:"order-cell-delete icon align-middle"},Ps=o("h4",{class:"text-center"},"Вы действительно хотите отказаться от услуг этого пользователя?",-1),As={class:"text-center"},Bs=o("h2",{class:"text-center mt-3"},"Выставите рейтинг исполнителя",-1),Ds={class:"w-100 d-flex justify-content-center"},Fs={id:"my-orders",class:"col-12 col-lg-8 right-block"},Rs={class:"rounded-block tall"},Ns=o("h2",null,"Мои запросы",-1);function Us(e,t,n,r,s,i){const _=m("ModalPairButtonsComponent"),u=m("ModalComponent"),f=m("UserPropertiesComponent"),C=m("ButtonComponent"),b=m("NoDataComponent"),g=m("RatingLineComponent"),d=m("TabsComponent"),h=m("OrdersTabsComponent");return l(),c(v,null,[a(u,{id:"order-closing-confirm-modal",head:"Закрытие заявки"},{default:O(()=>[Ss,a(_,{onClickYes:i.closingOrder},null,8,["onClickYes"])]),_:1}),a(u,{id:"order-resume-confirm-modal",head:"Возобновление заявки"},{default:O(()=>[Os,a(_,{onClickYes:i.resumingOrder},null,8,["onClickYes"])]),_:1}),a(u,{id:"order-resumed-modal",head:"Ваша заявка снова на модерации!"},{default:O(()=>[o("img",{class:"w-100",src:n.resume_image},null,8,Is)]),_:1}),a(u,{id:"order-delete-confirm-modal",head:"Удаление заявки"},{default:O(()=>[Ms,a(_,{onClickYes:i.deletingOrder},null,8,["onClickYes"])]),_:1}),a(u,{id:"order-performers-modal",head:"Исполнители"},{default:O(()=>[s.performers.length?(l(),c("table",Ts,[(l(!0),c(v,null,S(s.performers,w=>(l(),c("tr",{key:w.id},[o("td",null,[a(f,{user:w,small:!0,use_rating:!0,allow_change_rating:!1},null,8,["user"])]),o("td",$s,[T(a(C,{class:"btn btn-primary",text:"Отказать",onClick:Z=>i.removePerformer(w.id)},null,8,["onClick"]),[[D,s.showRefuseButton]])])]))),128))])):(l(),I(b,{key:1}))]),_:1}),a(u,{id:"order-removing-performer-confirm-modal",head:"Отказ от услуг"},{default:O(()=>[Ps,a(_,{onClickYes:i.removingPerformer},null,8,["onClickYes"])]),_:1}),a(u,{id:"order-closed-modal",head:"Заявка успешно закрыта!"},{default:O(()=>[o("div",As,[Bs,s.closingOrderUser?(l(),I(f,{key:0,user:s.closingOrderUser,use_rating:!1,allow_change_rating:!1},null,8,["user"])):x("",!0),o("div",Ds,[a(g,{income_rating:0,allow_change_rating:!0,center:!0,value:s.rating,"onUpdate:value":t[0]||(t[0]=w=>s.rating=w)},null,8,["value"])]),a(C,{class:"btn btn-primary w-50 m-auto mt-3",text:"Отправить","data-bs-dismiss":"modal",onClick:i.setRating},null,8,["onClick"])])]),_:1}),o("div",Fs,[o("div",Rs,[Ns,a(d,{tabs:s.tabs,show_counters:!0,active:s.activeTab,onChangeTab:i.changeTab},null,8,["tabs","active","onChangeTab"]),a(h,{user_id:s.userId,tabs:s.tabs,active_tab:s.activeTab,edit_order_url:n.edit_order_url,subscription_mode:!1,chat_mode:!1,onClosingOrder:i.closeOrder,onResumingOrder:i.resumeOrder,onDeletingOrder:i.deleteOrder,onPerformers:i.getPerformers,onChangePage:i.changePage},null,8,["user_id","tabs","active_tab","edit_order_url","onClosingOrder","onResumingOrder","onDeletingOrder","onPerformers","onChangePage"])])])],64)}const H=y(xs,[["render",Us]]),js={extends:H,name:"MyHelpListComponent",created(){let e=this,t;window.Echo.private("notice_"+this.userId).listen(".notice",n=>{(n.notice==="new_performer"||n.notice==="remove_performer")&&(t=e.getOrderIndex("active",n.order.id),t!==null?e.tabs.active.orders[t].performers=n.performers:e.refreshOrders(),n.notice!=="remove_performer"?axios.get(e.read_unread_by_performer).then(function(r){window.emitter.emit("read-unread-by-my-help")}):window.emitter.emit("read-unread-by-my-help"))})},data(){return{tabs:{active:{name:"В работе",counter:0,orders:Array,links:[]}}}},props:{read_unread_by_performer:String}},Es={id:"my-help",class:"col-12 col-lg-8 right-block"},Ls={class:"rounded-block tall"},zs=o("h2",null,"Моя помощь",-1);function Hs(e,t,n,r,s,i){const _=m("TabsComponent"),u=m("OrdersTabsComponent");return l(),c("div",Es,[o("div",Ls,[zs,a(_,{tabs:s.tabs,show_counters:!0,active:e.activeTab,onChangeTab:e.changeTab},null,8,["tabs","active","onChangeTab"]),a(u,{user_id:e.userId,tabs:s.tabs,active_tab:e.activeTab,subscription_mode:!1,chat_mode:!1,onChangePage:e.changePage},null,8,["user_id","tabs","active_tab","onChangePage"])])])}const Ks=y(js,[["render",Hs]]),Ys={name:"OrderRespondModalComponent",components:{ModalComponent:P},props:{order_id:Number,order_name:String,order_date:String,order_address:String,chat_url:String}},Gs={class:"bg-gray"},Vs=o("br",null,null,-1),Js=o("hr",null,null,-1),Zs={class:"w-100 text-center"},qs=["href"],Qs=o("hr",null,null,-1),Ws=o("h1",{class:"text-orange text-center"},"Спасибо!",-1);function Xs(e,t,n,r,s,i){const _=m("ModalComponent");return l(),I(_,{id:"order-respond-modal",head:"Сообщение"},{default:O(()=>[o("h3",Gs,[M("Спасибо, что откликнулись"),Vs,M("на заяку «"+p(n.order_name)+"» от "+p(n.order_date),1)]),Js,o("p",Zs,[o("a",{href:n.chat_url+"?id="+n.order_id},"Подробности вы можете обсудить в чате.",8,qs)]),Qs,Ws]),_:1})}const se=y(Ys,[["render",Xs]]),eo={extends:H,name:"MySubscriptionsComponent",components:{OrderRespondModalComponent:se},created(){window.emitter.on("refresh-complete",()=>{this.tabs.open.orders.length||window.emitter.emit("my-subscriptions",!1)}),window.Echo.private("notice_"+this.userId).listen(".notice",e=>{e.notice==="new_order_in_subscription"&&this.refreshOrders()})},data(){return{userId:Number,respondOrderId:0,respondOrderName:"",respondOrderDate:"",respondOrderAddress:"",tabs:{open:{name:"Открыты",counter:0,orders:Array,links:[]}},subscription:0}},props:{unsubscribe_url:String,order_response_url:String,orders_urls:String,orders_map_url:String,read_order_url:String,chat_url:String},methods:{unsubscribe(e){let t=this;$.each(e,function(n,r){if(r.subscription.subscriber_id===t.userId)return t.subscription=r.subscription,$("#unsubscribe-confirm-modal").modal("show"),!1})},unsubscribing(){let e=this;axios.post(e.unsubscribe_url,{_token:window.tokenField,id:e.subscription.id}).then(function(t){e.refreshOrders()})},orderRespond(e){let t=this;axios.post(this.order_response_url,{_token:window.tokenField,id:e.id}).then(function(n){t.respondOrderId=e.id,t.respondOrderName=e.name,t.respondOrderDate=e.date,t.respondOrderAddress=e.address,$("#order-respond-modal").modal("show")}).catch(function(n){console.log(n)}),axios.get(this.read_order_url+"?order_id="+e.id).then(function(n){window.emitter.emit("read-order",e.id)})}}},to=o("h4",{class:"text-center"},"Вы действительно хотите отписаться от этого пользователя?",-1),no={id:"my-subscriptions",class:"col-12 col-lg-8 right-block"},so={class:"rounded-block tall"},oo=o("h2",null,"Мои подписки",-1);function ro(e,t,n,r,s,i){const _=m("OrderRespondModalComponent"),u=m("ModalPairButtonsComponent"),f=m("ModalComponent"),C=m("TabsComponent"),b=m("OrdersTabsComponent");return l(),c(v,null,[a(_,{order_id:s.respondOrderId,order_name:s.respondOrderName,order_date:s.respondOrderDate,order_address:s.respondOrderAddress,chat_url:n.chat_url},null,8,["order_id","order_name","order_date","order_address","chat_url"]),a(f,{id:"unsubscribe-confirm-modal",head:"Закрытие подписки"},{default:O(()=>[to,a(u,{onClickYes:i.unsubscribing},null,8,["onClickYes"])]),_:1}),o("div",no,[o("div",so,[oo,a(C,{tabs:s.tabs,show_counters:!0,active:e.activeTab},null,8,["tabs","active"]),a(b,{user_id:s.userId,tabs:s.tabs,active_tab:e.activeTab,subscription_mode:!0,chat_mode:!1,orders_map_url:n.orders_map_url,onChangePage:e.changePage,onRespond:i.orderRespond,onUnsubscribe:i.unsubscribe},null,8,["user_id","tabs","active_tab","orders_map_url","onChangePage","onRespond","onUnsubscribe"])])])],64)}const io=y(eo,[["render",ro]]),ao={name:"IncentivesComponent",components:{ModalComponent:P,ButtonComponent:A,NoDataComponent:z,OrdersTabsComponent:ne,ModalPairButtonsComponent:J,PaginatorComponent:V},created(){this.userId=parseInt(this.user_id),this.getIncentives(this.get_incentives_url,!1),window.Echo.private("incentive_"+this.userId).listen(".incentive",e=>{if(e.notice==="remove_incentive"){let t=null;$.each(this.incentives,function(n,r){if(r.id===e.incentive.id)return t=n,!1}),t!==null&&this.getIncentives(this.get_incentives_url,!1)}else e.notice==="new_incentive"&&this.getIncentives(this.get_incentives_url,!1)})},data(){return{incentives:[],links:[],userId:Number,deletingActionId:0}},props:{user_id:String,get_incentives_url:String,incentive_url:String,delete_incentives_url:String},methods:{confirmDeleteIncentive(e){$("#incentive-delete-confirm-modal").modal("show"),this.deletingActionId=e},deleteIncentive(){let e=this;axios.post(e.delete_incentives_url,{_token:window.tokenField,id:e.deletingActionId}).then(function(t){})},getIncentives(e,t){let n=this;axios.get(e).then(function(r){n.incentives=r.data.data,n.links=r.data.links,n.incentives.length||window.emitter.emit("incentives",!1),t&&t()})},changePage(e){$(".without-tabs").fadeOut(()=>{this.getIncentives(e.url,()=>{activeTab.fadeIn()})})},getDate(e){return new Date(e).toLocaleDateString("ru-RU")}}},lo=o("h4",{class:"text-center"},"Вы действительно хотите удалить эту акцию?",-1),co={id:"incentives",class:"col-12 col-lg-8 right-block"},uo={class:"rounded-block tall"},mo=o("h2",null,"Поощрения от партнеров",-1),_o={key:0,class:"h-100 without-tabs d-flex flex-column justify-content-between"},ho={class:"row"},po={class:"item-in-list action text-center p-3"},go={class:"lh-sm fs-5"},fo={class:"fs-6"},wo=o("br",null,null,-1),bo={class:"fw-bold text-uppercase"},ko={class:"fs-6 fw-bold"},vo={class:"w-100 d-flex justify-content-center"},Co=["href"];function yo(e,t,n,r,s,i){const _=m("ModalPairButtonsComponent"),u=m("ModalComponent"),f=m("ButtonComponent"),C=m("PaginatorComponent"),b=m("NoDataComponent");return l(),c(v,null,[a(u,{id:"incentive-delete-confirm-modal",head:"Закрытие заявки"},{default:O(()=>[lo,a(_,{onClickYes:i.deleteIncentive},null,8,["onClickYes"])]),_:1}),o("div",co,[o("div",uo,[mo,s.incentives.length?(l(),c("div",_o,[o("div",ho,[(l(!0),c(v,null,S(s.incentives,g=>(l(),c("div",{class:"col-lg-6 col-sm-12 mb-2",key:g.id},[o("div",po,[o("div",go,p(g.action_full.name),1),o("div",fo,[M("Подарок от компании"),wo,o("span",bo,"«"+p(g.action_full.partner.name)+"»",1)]),o("div",ko,"Дата: "+p(i.getDate(g.action_full.start)+" - "+i.getDate(g.action_full.end)),1),o("div",vo,[o("a",{class:"w-50 me-1",href:n.incentive_url+"?id="+g.action_full.id},[a(f,{class:"btn btn-primary w-100 m-auto",text:"Подробнее"})],8,Co),a(f,{class:"btn btn-primary w-50 m-auto",text:"Удалить",onClick:d=>i.confirmDeleteIncentive(g.id)},null,8,["onClick"])])])]))),128))]),a(C,{links:s.links,tab_key:"actions",onPaginate:i.changePage},null,8,["links","onPaginate"])])):(l(),I(b,{key:1}))])])],64)}const xo=y(ao,[["render",yo]]),So={extends:H,name:"MyChatsComponent",props:{chat_url:String},data(){return{userId:Number,tabs:{my_orders:{name:"Мои заявки",counter:0,orders:Array,links:[]},performer:{name:"Я исполнитель",counter:0,orders:Array,links:[]}}}}},Oo={id:"my-chats",class:"col-12 col-lg-8 right-block"},Io={class:"rounded-block tall"},Mo=o("h2",null,"Мои чаты",-1);function To(e,t,n,r,s,i){const _=m("TabsComponent"),u=m("OrdersTabsComponent");return l(),c("div",Oo,[o("div",Io,[Mo,a(_,{tabs:s.tabs,show_counters:!0,active:e.activeTab,onChangeTab:e.changeTab},null,8,["tabs","active","onChangeTab"]),a(u,{user_id:s.userId,tabs:s.tabs,active_tab:e.activeTab,subscription_mode:!1,chat_mode:!0,chat_url:n.chat_url,onChangePage:e.changePage},null,8,["user_id","tabs","active_tab","chat_url","onChangePage"])])])}const $o=y(So,[["render",To]]),Po={name:"EditOrderComponent",components:{OrderMapComponent:le,ModalComponent:P,InputComponent:N,TextAreaComponent:U,CheckboxComponent:L,OrderImagesComponent:de,ButtonComponent:A},created(){let e=this;if(this.step&&(this.currentStep=parseInt(this.step)),this.wizardImages=JSON.parse(this.images),this.orderTypes=JSON.parse(this.order_types),this.sessionSteps=JSON.parse(this.session),this.selectedOrderType=1,this.selectedOrderSubType=1,this.order){let t=JSON.parse(this.order);this.orderId=t.id,this.currentStep=1,this.stepsHeadsH1[0]="Редактирование заявки №:"+t.id,this.selectedOrderType=parseInt(t.order_type_id),this.selectedOrderSubType=parseInt(t.subtype_id),this.orderName=t.name,this.needPerformers=t.need_performers;for(let n=1;n<=3;n++)this.photo=null;$.each(t.images,function(n,r){e["photo"+r.position]=r.image}),window.singlePoint=[t.latitude,t.longitude],this.address=t.address,this.descriptionShort=t.description_short,this.descriptionFull=t.description_full}this.sessionSteps.length&&(this.currentStep=this.sessionSteps.length+1,this.selectedOrderType=parseInt(this.sessionSteps[0].order_type_id),this.selectedOrderSubType=parseInt(this.sessionSteps[0].subtype_id),this.orderName=this.sessionSteps[0].name,this.sessionSteps.length>1&&(this.needPerformers=this.sessionSteps[1].need_performers),this.sessionSteps.length>2&&(window.singlePoint=[this.sessionSteps[2].latitude,this.sessionSteps[2].longitude],this.address=this.sessionSteps[2].address)),window.emitter.on("remove-order-photo",t=>{let n=this;this.orderId&&this["photo"+t]&&axios.post(this.delete_order_image_url,{_token:window.tokenField,id:n.orderId,pos:t}).then(function(r){n["photo"+t]=null})})},props:{next_step_url:String,prev_step_url:String,order_preview_url:String,delete_order_image_url:String,images:String,order_types:String,session:String,order:String,yandex_api_key:String,input_image_hover:String},data(){return{disabledButtons:!1,sessionSteps:Array,currentStep:1,wizardImages:Array,orderId:null,orderTypes:Array,selectedOrderType:1,orderSubTypes:Array,selectedOrderSubType:null,orderName:"",needPerformers:1,photo1:null,photo2:null,photo3:null,address:"",descriptionShort:"",descriptionFull:"",stepsHeadsH1:["Создайте новую заявку!","Выберите количество помощников","Укажите адрес оказания помощи","Дополнительная информация"],stepsHeadsH2:["Вид помощи","Количество исполнителей","Адрес оказания помощи","Укажите необходимую информацию"],stepsDescriptions:["Выберите требуемый вам вид помощи и нажмите «Далее»","Выберите количество исполнителей и нажмите кнопку «Далее»","Укажите адрес оказания помощи и нажмите кнопку «Далее»","Напишите дополнительную информацию о необходимой помощи и нажмите кнопку «Далее»"],errors:{name:null,need_performers:null,photo1:null,photo2:null,photo3:null,address:null,description_short:null,description_full:null}}},methods:{nextStep(){if(this.currentStep===3)this.$refs.OrderMapComponent.address?this.$refs.OrderMapComponent.getApiPlaceMark():this.$refs.OrderMapComponent.addressError="Укажите адрес!";else{let e=this,t=new FormData;this.disabledButtons=!0,t.append("_token",window.tokenField),t.append("order_type_id",this.selectedOrderType),this.selectedOrderSubType&&t.append("subtype_id",this.selectedOrderSubType),t.append("name",this.orderName),t.append("need_performers",this.needPerformers),this.descriptionShort&&t.append("description_short",this.descriptionShort),this.descriptionFull&&t.append("description_full",this.descriptionFull),t.append("photo1",$("input[name=photo1]")[0].files[0]),t.append("photo2",$("input[name=photo2]")[0].files[0]),t.append("photo3",$("input[name=photo3]")[0].files[0]),this.orderId&&t.append("id",this.orderId),axios.post(this.next_step_url,t).then(function(n){e.currentStep!==4?(e.currentStep++,e.disabledButtons=!1):(setTimeout(function(){window.location.href=e.order_preview_url},3e3),$("#complete-modal").modal("show").on("hidden.bs.modal",()=>{window.location.href=e.order_preview_url}))}).catch(function(n){e.disabledButtons=!1,$.each(n.response.data.errors,(r,s)=>{e.errors[r]=s[0]})})}},prevStep(){let e=this;this.disabledButtons=!0,axios.get(this.prev_step_url+"?id="+(this.orderId?this.orderId:"")).then(function(t){e.currentStep--,e.disabledButtons=!1}).catch(function(t){console.log(t)})},disableButtons(e){this.disabledButtons=e},setPlaceMark(e){this.address=e;let t={_token:window.tokenField,address:this.address,latitude:window.singlePoint[0],longitude:window.singlePoint[1]};this.orderId&&(t.id=this.orderId),axios.post(this.next_step_url,t).then(()=>{setTimeout(()=>{this.currentStep++,this.disabledButtons=!1},1500)})}}},Ao=["src"],Bo={class:"col-12 col-lg-6"},Do={class:"rounded-block tall"},Fo={class:"mb-4"},Ro={id:"progress-bar"},No=o("label",null,"Заявка сформирована на:",-1),Uo={class:"progress",role:"progressbar","aria-valuenow":"25","aria-valuemin":"0","aria-valuemax":"100"},jo={class:"inputs-step"},Eo={class:"form-check mb-1"},Lo=["id","value"],zo=["for"],Ho={key:0,class:"sub-types-block"},Ko=["id","value"],Yo=["for"],Go=o("h2",{class:"mt-4"},"Название заявки",-1),Vo={class:"inputs-step"},Jo=o("h2",{class:"mt-4"},"Добавьте изображения",-1),Zo={class:"row"},qo={class:"inputs-step"},Qo={class:"inputs-step"},Wo={class:"bottom-block"},Xo={class:"d-flex align-items-center justify-content-center justify-content-md-end"},er={class:"col-12 col-lg-6"},tr={class:"rounded-block three-quarter d-none d-md-flex align-items-center justify-content-center"},nr=["src"],sr={id:"map-steps"},or={class:"rounded-block one-quarter"};function rr(e,t,n,r,s,i){const _=m("ModalComponent"),u=m("InputComponent"),f=m("OrderImagesComponent"),C=m("OrderMapComponent"),b=m("TextAreaComponent"),g=m("ButtonComponent");return l(),c(v,null,[a(_,{id:"complete-modal",head:"Ваша заявка успешно зарегистрирована! Сейчас Вы будете перенаправлены на страницу предпросмотра заяки."},{default:O(()=>[o("img",{class:"w-100",src:s.wizardImages[4]},null,8,Ao)]),_:1}),o("div",Bo,[o("div",Do,[o("h1",Fo,p(s.stepsHeadsH1[s.currentStep-1]),1),T(o("div",Ro,[No,o("div",Uo,[o("div",{class:"progress-bar",style:Q("width:"+(s.currentStep-1)*25+"%")},p((s.currentStep-1)*25+"%"),5)])],512),[[D,s.currentStep>1]]),o("h2",null,p(s.stepsHeadsH2[s.currentStep-1]),1),T(o("div",jo,[(l(!0),c(v,null,S(s.orderTypes,d=>(l(),c("div",{class:"radio-group",key:"orderType"+d.id},[o("div",Eo,[T(o("input",{id:"order-type-"+d.id,name:"order_type",value:d.id,class:"form-check-input",type:"radio","onUpdate:modelValue":t[0]||(t[0]=h=>s.selectedOrderType=h)},null,8,Lo),[[q,s.selectedOrderType]]),o("label",{class:"form-check-label",for:"order-type-"+d.id},p(d.name),9,zo)]),d.subtypes_active.length&&d.id===s.selectedOrderType?(l(),c("div",Ho,[(l(!0),c(v,null,S(d.subtypes_active,h=>(l(),c("div",{class:"form-check mb-1 small",key:"orderType"+h.id},[T(o("input",{id:"order-sub-type-"+h.id,name:"order_sub_type",value:h.id,class:"form-check-input",type:"radio","onUpdate:modelValue":t[1]||(t[1]=w=>s.selectedOrderSubType=w)},null,8,Ko),[[q,s.selectedOrderSubType]]),o("label",{class:"form-check-label",for:"order-sub-type-"+h.id},p(h.name),9,Yo)]))),128))])):x("",!0)]))),128)),Go,a(u,{type:"text",name:"name",min:"3",max:"50",placeholder:"Введите название заявки",error:s.errors.name,value:s.orderName,"onUpdate:value":t[2]||(t[2]=d=>s.orderName=d),onChange:t[3]||(t[3]=d=>s.errors.name=null)},null,8,["error","value"])],512),[[D,s.currentStep===1]]),T(o("div",Vo,[a(u,{type:"number",name:"need_performers",min:"1",max:"20",error:s.errors.need_performers,value:s.needPerformers,"onUpdate:value":t[4]||(t[4]=d=>s.needPerformers=d),onChange:t[5]||(t[5]=d=>s.errors.need_performers=null)},null,8,["error","value"]),Jo,o("div",Zo,[a(f,{errors:s.errors,photo1:s.photo1,photo2:s.photo2,photo3:s.photo2,input_image_hover:n.input_image_hover},null,8,["errors","photo1","photo2","photo3","input_image_hover"])])],512),[[D,s.currentStep===2]]),T(o("div",qo,[a(C,{incoming_address:s.address,yandex_api_key:n.yandex_api_key,get_place_mark:!1,onDisabledButtons:i.disableButtons,onSetPlaceMark:i.setPlaceMark,ref:"OrderMapComponent"},null,8,["incoming_address","yandex_api_key","onDisabledButtons","onSetPlaceMark"])],512),[[D,s.currentStep===3]]),T(o("div",Qo,[a(b,{label:"Краткое описание (до 200 символов)",name:"description_short",max:"200",value:s.descriptionShort,"onUpdate:value":t[6]||(t[6]=d=>s.descriptionShort=d),error:s.errors.description_short,onChange:t[7]||(t[7]=d=>s.errors.description_short=null)},null,8,["value","error"]),a(b,{label:"Полное описание (до 1000 символов)",name:"description_full",max:"1000",value:s.descriptionFull,"onUpdate:value":t[8]||(t[8]=d=>s.descriptionFull=d),error:s.errors.description_full,onChange:t[9]||(t[9]=d=>s.errors.description_full=null)},null,8,["value","error"])],512),[[D,s.currentStep===4]]),o("div",Wo,[o("div",Xo,[s.currentStep>1?(l(),I(g,{key:0,class:"btn btn-secondary link-cover",text:"Назад",disabled:s.disabledButtons,onClick:i.prevStep},null,8,["disabled","onClick"])):x("",!0),a(g,{class:"btn btn-secondary link-cover",text:"Далее",disabled:s.disabledButtons,onClick:i.nextStep},null,8,["disabled","onClick"])])])])]),o("div",er,[o("div",tr,[T(o("img",{class:"right-image",src:s.wizardImages[s.currentStep-1]},null,8,nr),[[D,s.currentStep!==3]]),T(o("div",sr,null,512),[[D,s.currentStep===3]])]),o("div",or,[o("p",null,p(s.stepsDescriptions[s.currentStep-1]),1)])])],64)}const ir=y(Po,[["render",rr]]),ar={name:"OrderCarouselImagesComponent",props:{images:Object}},lr={key:0,class:"images owl-carousel mt-3"},dr=["href"];function cr(e,t,n,r,s,i){return n.images.length?(l(),c("div",lr,[(l(!0),c(v,null,S(n.images,_=>(l(),c("a",{class:"fancybox",key:_,href:"/"+_.image},[o("div",{class:"image",style:Q(`background-image:url(/${_.image});`)},null,4)],8,dr))),128))])):x("",!0)}const oe=y(ar,[["render",cr]]),ur={name:"OrderPropertiesComponent",props:{name:String,type:String,subtype:String,address:String,description_short:String}},mr={key:0,class:"order-name text-dark text-left mt-3 mb-4"},_r={class:"order-type text-dark text-left mt-3 h5"},hr={key:1,class:"subtypes"},pr={class:"mb-1 text-left"},gr=o("b",null,"Адрес:",-1),fr={key:2,class:"fw-bold text-left mt-2 mb-0"},wr={key:3,class:"text-left order-description mb-1"};function br(e,t,n,r,s,i){return l(),c(v,null,[n.name?(l(),c("h2",mr,p(n.name),1)):x("",!0),o("h2",_r,p(n.type),1),n.subtype?(l(),c("ul",hr,[o("li",null,p(n.subtype),1)])):x("",!0),o("p",pr,[gr,M(" "+p(n.address),1)]),n.description_short?(l(),c("p",fr,"Описание:")):x("",!0),n.description_short?(l(),c("p",wr,p(n.description_short),1)):x("",!0)],64)}const re=y(ur,[["render",br]]);const kr={name:"OrdersComponent",components:{ModalComponent:P,OrderRespondModalComponent:se,UserPropertiesComponent:E,OrderCarouselImagesComponent:oe,OrderPropertiesComponent:re,ButtonComponent:A},created(){let e=this;this.userId=parseInt(this.user_id),this.filterType=parseInt(this.order_type),this.filterPerformersFrom=parseInt(this.performers_from),this.filterPerformersTo=parseInt(this.performers_to),this.orderTypes=JSON.parse(this.order_types),this.previewFlag=parseInt(this.get_preview_flag),window.pointsContainer=$("#points-container"),window.cickedTarget=null,window.pointsOpenedFlag=!1,window.clickedToCluster=t=>{this.selectedPoints=t.properties.get("geoObjects"),window.cickedTarget=t,$.each(this.selectedPoints,function(n,r){e.checkUnreadOrders(r.properties.get("orderId"))}),this.showSelectedPointsDie()},window.clickedToPoint=t=>{this.checkUnreadOrders(t.properties.get("orderId")),window.cickedTarget=t,this.selectedPoints=[t],this.showSelectedPointsDie()},window.hideSelectedPointsDie=(t,n)=>{(window.cickedTarget&&!t||window.cickedTarget&&t&&window.cickedTarget!==t)&&(window.cickedTarget.options.set("iconColor","#e6761b"),window.selectedPointsDie.animate({"margin-left":-1*(window.selectedPointsDie.width()+150)},"slow",()=>{window.pointsOpenedFlag=!1,n&&n()}))},this.order_id&&(window.openOrderId=parseInt(this.order_id)),window.emitter.on("map-is-ready",()=>{this.getOrders()}),window.Echo.channel("order_event").listen(".order",t=>{t.notice==="remove_order"?e.removeOrder(t):t.notice==="new_order_status"&&e.newStatusOrder(t)}),$(document).ready(function(){$("#close-selected-points").click(()=>{window.hideSelectedPointsDie()})})},props:{user_id:String,orders_url:String,get_orders_url:String,order_response_url:String,read_order_url:String,get_preview_url:String,subscription_url:String,chat_url:String,get_preview_flag:String,order_id:String,order_type:String,performers_from:String,performers_to:String,search:String,order_types:String},data(){return{userId:Number,orders:[],previewFlag:!1,showRespondButton:!0,selectedPoints:[],respondOrderId:0,respondOrderName:"",respondOrderDate:"",respondOrderAddress:"",openOrderId:0,orderTypes:Array,orderFullDescription:"",filterType:0,filterPerformersFrom:1,filterPerformersTo:20,searchingString:null}},methods:{getSearched(){this.filterType=0,this.filterPerformersFrom=1,this.filterPerformersTo=20,this.getOrders()},getOrders(){window.myMap.geoObjects.removeAll(),window.hideSelectedPointsDie();let e=this,t={_token:window.tokenField},n=this.get_orders_url,r=this.orders_url,s="?";e.previewFlag?(n=this.get_preview_url,this.showRespondButton=!1):(this.searchingString!==null?t.search=this.searchingString:this.search&&(t.search=this.search,this.searchingString=this.search),t.order_type=this.filterType,t.performers_from=this.filterPerformersFrom,t.performers_to=this.filterPerformersTo),$.each(t,function(i,_){i!=="_token"&&_&&(r+=s+i+"="+_,s="&")}),window.history.pushState(t,"Оказать помощь. Карта",r),axios.post(n,t).then(function(i){window.placemarks=[],window.subscriptions=[],window.unreadOrders=[],i.data.subscriptions.length&&$.each(i.data.subscriptions,function(_,u){window.subscriptions.push(u.user_id),u.orders.length&&$.each(u.orders,function(f,C){window.unreadOrders.push(C.id)})}),i.data.orders.length&&($.each(i.data.orders,function(_,u){let f=new Date(u.created_at),C=!1;if(u.performers.length){for(let b=0;b<u.performers.length;b++)if(u.performers[b].id===e.userId){C=!0;break}}C||(window.placemarks.push(getPlaceMark([u.latitude,u.longitude],{placemarkId:_,orderId:u.id,name:u.name,address:u.address,orderType:u.order_type.name,images:u.images,subtype:u.sub_type?u.sub_type.name:null,need_performers:u.need_performers,performers:u.performers.length,user:u.user,date:f.toLocaleDateString("ru-RU"),description_short:u.description_short,description_full:u.description_full})),e.previewFlag?(e.previewFlag=!1,e.forceOpenOrder(0)):window.openOrderId&&window.openOrderId===u.id&&e.forceOpenOrder(_))}),window.clusterer=new ymaps.Clusterer({preset:"islands#darkOrangeClusterIcons",clusterDisableClickZoom:!0,clusterOpenBalloonOnClick:!1,clusterBalloonPanelMaxMapArea:0,clusterBalloonMaxHeight:200}),window.myMap.geoObjects.events.add("click",function(_){let u=_.get("target");u.options.set("iconColor","#bc202e"),u.properties.get("geoObjects")?window.pointsOpenedFlag?window.hideSelectedPointsDie(u,()=>{window.clickedToCluster(u)}):window.clickedToCluster(u):window.pointsOpenedFlag?window.hideSelectedPointsDie(u,()=>{window.clickedToPoint(u)}):window.clickedToPoint(u)}),window.clusterer.add(window.placemarks),window.myMap.geoObjects.add(window.clusterer))}).catch(function(i){})},forceOpenOrder(e){window.openOrderId=null,window.cickedTarget=window.placemarks[e],window.placemarks[e].options.set("iconColor","#bc202e"),window.clickedToPoint(window.placemarks[e])},showSelectedPointsDie(){window.enablePointImagesCarousel(),window.bindFancybox(),window.selectedPointsDie.animate({"margin-left":0},"slow",()=>{window.pointsOpenedFlag=!0})},getSubscription(e){return window.subscriptions.includes(e)},setSubscription(e,t){let n=$(e.target);n.fadeOut("fast",()=>{axios.get(this.subscription_url+"?user_id="+t).then(function(r){if(r.data.subscription)n.removeClass("icon-bell-check").addClass("icon-bell-cross"),window.subscriptions.push(t);else{n.removeClass("icon-bell-cross").addClass("icon-bell-check");let s=window.subscriptions.indexOf(t);s!==1&&window.subscriptions.splice(s,app1)}window.bellRinging(n),n.fadeIn("fast")})})},checkUnreadOrders(e){let t=window.unreadOrders.indexOf(e);t!==-1&&axios.get(this.read_order_url+"?order_id="+e).then(function(n){window.unreadOrders.splice(t,1),window.emitter.emit("read-order",e)})},getOrderFullDescription(e){this.orderFullDescription=e,$("#order-full-description-modal").modal("show")},orderRespond(e){let t=this;axios.post(this.order_response_url,{_token:window.tokenField,id:e.properties.get("orderId")}).then(function(n){t.respondOrderId=e.properties.get("orderId"),t.respondOrderName=e.properties.get("name"),t.respondOrderDate=e.properties.get("date"),t.respondOrderAddress=e.properties.get("address"),$("#order-respond-modal").modal("show")}).catch(function(n){console.log(n)})},copyLink(e){navigator.clipboard&&window.navigator.clipboard.writeText(this.get_orders_url+"?id="+e).then(()=>{window.showMessage("Ссылка скопирована!")})},newStatusOrder(e){if(e.order.status===2){let t=window.placemarks.length,n=new Date(e.order.created_at);window.placemarks.push(getPlaceMark([e.order.latitude,e.order.longitude],{placemarkId:t,orderId:e.order.id,name:e.order.name,address:e.order.address,orderType:e.order_type.name,images:e.images,subtype:e.sub_type.name,need_performers:e.order.need_performers,performers:e.performers.length,user:e.user,date:n.toLocaleDateString("ru-RU"),description_short:e.order.description_short,description_full:e.order.description_full})),window.clusterer.add(window.placemarks)}else this.removeOrder(e)},removeOrder(e){let t=window.unreadOrders.indexOf(e.order.id);t!==-1&&window.unreadOrders.splice(t,1);for(let n=0;n<window.placemarks.length;n++)if(window.placemarks[n].properties.get("orderId")===e.order.id){window.clusterer.remove(window.placemarks[n]),window.placemarks.splice(n,1);break}window.hideSelectedPointsDie()}}},F=e=>(ue("data-v-0a506413"),e=e(),me(),e),vr={class:"p-3"},Cr={class:"rounded-block mb-2 p-3 h-auto"},yr={class:"row d-flex justify-content-center ps-3 pe-3"},xr={class:"col-lg-2 col-sm-12 col-12 row d-flex align-items-end m-0 p-0"},Sr=F(()=>o("label",{class:"ms-3"},"Виды помощи",-1)),Or=F(()=>o("option",{value:"0"},"Все",-1)),Ir=["value"],Mr={class:"col-lg-4 col-12 row d-flex align-items-end m-0 p-0"},Tr=F(()=>o("label",{class:"ms-3"},"Кол-во исполнителей",-1)),$r={class:"col-sm-6 col-12"},Pr=["value"],Ar={class:"col-sm-6 col-12"},Br=["value"],Dr={class:"col-lg-4 col-12 mt-lg-0 mt-2 row d-flex align-items-end m-0 p-0"},Fr=F(()=>o("label",{class:"ms-3"},"Поиск",-1)),Rr={class:"form-group mt-2"},Nr={class:"col-lg-2 col-sm-12 col-12 d-flex align-items-end m-0"},Ur={id:"map-container",class:"rounded-block"},jr=F(()=>o("div",{id:"map"},null,-1)),Er={id:"selected-points"},Lr=F(()=>o("i",{id:"close-selected-points",class:"icon-close2"},null,-1)),zr={id:"points-container"},Hr={class:"text-center mt-4 pt-1"},Kr={class:"w-100 d-flex align-items-center justify-content-between"},Yr=["onClick"],Gr={key:0,class:"fw-bold text-left mt-0 mb-2"},Vr=["onClick"],Jr={class:"text-left mb-2"},Zr=F(()=>o("b",null,"Кол-во исполнителей:",-1)),qr=["onClick"],Qr=F(()=>o("span",null,"Откликнуться на заявку",-1)),Wr=[Qr],Xr=["onClick"],ei=F(()=>o("span",null,"Скопировать ссылку",-1)),ti=[ei],ni=F(()=>o("hr",null,null,-1));function si(e,t,n,r,s,i){const _=m("OrderRespondModalComponent"),u=m("ModalComponent"),f=m("ButtonComponent"),C=m("UserPropertiesComponent"),b=m("OrderCarouselImagesComponent"),g=m("OrderPropertiesComponent");return l(),c(v,null,[a(_,{order_id:s.respondOrderId,order_name:s.respondOrderName,order_date:s.respondOrderDate,order_address:s.respondOrderAddress,chat_url:n.chat_url},null,8,["order_id","order_name","order_date","order_address","chat_url"]),a(u,{id:"order-full-description-modal",head:"Описание заявки"},{default:O(()=>[o("p",vr,p(s.orderFullDescription),1)]),_:1}),o("div",Cr,[o("div",yr,[o("div",xr,[Sr,T(o("select",{name:"order_type",class:"form-select","onUpdate:modelValue":t[0]||(t[0]=d=>s.filterType=d)},[Or,(l(!0),c(v,null,S(s.orderTypes,(d,h)=>(l(),c("option",{key:"order-type"+d.id,value:d.id},p(d.name),9,Ir))),128))],512),[[K,s.filterType]])]),o("div",Mr,[Tr,o("div",$r,[T(o("select",{name:"performers_from",class:"form-select mb-2 mb-sm-0","onUpdate:modelValue":t[1]||(t[1]=d=>s.filterPerformersFrom=d)},[(l(),c(v,null,S(19,d=>o("option",{key:"performers-from"+d,value:d},p("от "+d),9,Pr)),64))],512),[[K,s.filterPerformersFrom]])]),o("div",Ar,[T(o("select",{name:"performers_from",class:"form-select","onUpdate:modelValue":t[2]||(t[2]=d=>s.filterPerformersTo=d)},[(l(),c(v,null,S(20,d=>o("option",{key:"performers-to"+d,value:d},p("до "+d),9,Br)),64))],512),[[K,s.filterPerformersTo]])])]),o("div",Dr,[Fr,o("div",Rr,[o("i",{class:"icon-search4",onClick:t[3]||(t[3]=(...d)=>i.getSearched&&i.getSearched(...d))}),T(o("input",{type:"text",name:"search",class:"form-control has-icon","onUpdate:modelValue":t[4]||(t[4]=d=>s.searchingString=d),onKeydown:t[5]||(t[5]=R(Y((...d)=>i.getSearched&&i.getSearched(...d),["prevent","exact"]),["enter"]))},null,544),[[ce,s.searchingString]])])]),o("div",Nr,[a(f,{class:"btn btn-primary w-100 mt-lg-0 mt-3",text:"Применить",onClick:i.getOrders},null,8,["onClick"])])])]),o("div",Ur,[jr,o("div",Er,[Lr,o("div",zr,[(l(!0),c(v,null,S(s.selectedPoints,d=>(l(),c("div",{class:"mb-3 order-block",key:d.properties.get("orderId")},[o("h2",Hr,p(d.properties.get("name")+" от "+d.properties.get("date")),1),o("div",Kr,[a(C,{user:d.properties.get("user"),small:!1,use_rating:!0,allow_change_rating:!1},null,8,["user"]),o("i",{onClick:h=>i.setSubscription(h,d.properties.get("user").id),class:B("subscribe-icon "+(i.getSubscription(d.properties.get("user").id)?"icon-bell-cross":"icon-bell-check"))},null,10,Yr)]),a(b,{images:d.properties.get("images")},null,8,["images"]),a(g,{type:d.properties.get("orderType"),subtype:d.properties.get("subtype"),address:d.properties.get("address"),description_short:d.properties.get("description_short")},null,8,["type","subtype","address","description_short"]),d.properties.get("description_full")?(l(),c("p",Gr,[o("a",{href:"#",onClick:Y(h=>i.getOrderFullDescription(d.properties.get("description_full")),["prevent"])},"Полное описание »",8,Vr)])):x("",!0),o("p",Jr,[Zr,M(" "+p(d.properties.get("performers")+" из "+d.properties.get("need_performers")),1)]),s.showRespondButton?(l(),c("button",{key:1,onClick:h=>i.orderRespond(d),type:"button",class:"btn btn-primary w-100"},Wr,8,qr)):x("",!0),o("button",{onClick:h=>i.copyLink(d.properties.get("orderId")),type:"button",class:"btn btn-primary w-100 mt-3"},ti,8,Xr),ni]))),128))])])])],64)}const oi=y(kr,[["render",si],["__scopeId","data-v-0a506413"]]),ri={name:"MessageComponent",components:{UserNameComponent:j,AvatarComponent:G},props:{message:Object},methods:{getMessageTime(e){let t=new Date(e),n=t.getMinutes().toString();return n=n.length===1?"0"+n:n,t.getHours()+":"+n}}},ii={class:"message-block"},ai={class:"message"},li={class:"author"};function di(e,t,n,r,s,i){const _=m("AvatarComponent"),u=m("UserNameComponent");return l(),c("div",ii,[a(_,{small:!0,avatar_image:n.message.user.avatar,avatar_props:n.message.user.avatar_props},null,8,["avatar_image","avatar_props"]),o("div",ai,[o("div",li,[a(u,{user:n.message.user},null,8,["user"]),o("span",null,p(i.getMessageTime(n.message.created_at)),1)]),o("div",null,p(n.message.body),1)])])}const ci=y(ri,[["render",di]]),ui={name:"ChatComponent",components:{ModalComponent:P,UserNameComponent:j,UserPropertiesComponent:E,OrderCarouselImagesComponent:oe,OrderPropertiesComponent:re,MessageComponent:ci,TextAreaComponent:U},created(){let e=this;this.userId=parseInt(this.user_id),this.chatOrder=JSON.parse(this.order),this.messages=this.chatOrder.messages,this.myCompanion=JSON.parse(this.companion),this.chatDate=this.getDate(this.chatOrder.created_at),window.bindFancybox(),this.scrollBottom(),window.Echo.private("chat_"+this.chatOrder.id).listen(".chat",t=>{t.message.user.id!==this.userId&&(e.messages.push(t.message),e.scrollBottom(),t.message.image&&e.bindLastFancyBox(),this.readMessage())}),window.Echo.channel("order_event").listen(".order",t=>{t.order.id===this.chatOrder.id&&(t.notice==="remove_order"||t.notice==="new_order_status")&&(window.location.href=e.chats_url)}),window.Echo.private("notice_"+this.userId).listen(".notice",t=>{t.notice==="remove_performer"&&(window.location.href=e.chats_url)})},props:{user_id:String,new_message_url:String,read_message_url:String,chats_url:String,order:String,companion:String},data(){return{allowSend:!0,userId:Number,chatOrder:Number,chatDate:String,myCompanion:Object,message:"",messages:[],previewImage:null,image:null,errors:{error:{message:null,image:null}}}},methods:{getUserAge(e){return window.getUserAge(e)},getDate(e){return window.convertTime(e)},newDate(e){if(e){let t=new Date(this.messages[e-1].created_at).getDate(),n=new Date(this.messages[e].created_at).getDate();return t!==n}else return!0},attachingFile(){this.errors.image=null;let e=this,t=new FileReader;this.image=$("input[name=image]")[0].files[0],(this.image.type==="image/jpeg"||this.image.type==="image/png")&&(t.onload=function(n){e.previewImage=n.target.result,e.scrollBottom(),e.bindLastFancyBox()},t.readAsDataURL(e.image))},detachImage(){this.errors.image=null,this.previewImage=null,this.image=null,$("input[name=image]").val("")},sendMessage(){if((this.message||this.image)&&this.allowSend){let e=this,t=new FormData;this.allowSend=!1,t.append("_token",window.tokenField),t.append("order_id",this.chatOrder.id),t.append("body",this.message),this.image&&t.append("image",this.image),axios.post(this.new_message_url,t).then(function(n){e.message="",e.previewImage=null,e.image=null,$("input[name=image]").val(""),e.messages.push(n.data),e.scrollBottom(),n.data.image&&e.bindLastFancyBox(),e.allowSend=!0}).catch(function(n){console.log(n),$.each(n.response.data.errors,(r,s)=>{e.errors[r]=s[0],e.allowSend=!0})})}},readMessage(){let e=this;axios.post(this.read_message_url,{_token:window.tokenField,id:e.chatOrder.id}).then(function(t){window.emitter.emit("read-message",e.chatOrder.id)}).catch(function(t){console.log(t)})},scrollBottom(){setTimeout(()=>{window.scrollBottomMessages()},500)},bindLastFancyBox(){setTimeout(()=>{$("a.fancybox").last().fancybox(window.fancyBoxSettings)},300)}}},mi=o("hr",null,null,-1),_i=o("h5",{class:"text-center"},"Информация о пользователе:",-1),hi={class:"text-center"},pi={id:"selected-points"},gi={class:"col-12 col-lg-8"},fi={class:"rounded-block tall white pt-4"},wi={class:"d-flex justify-content-start align-items-center mb-3"},bi=["href"],ki=o("i",{title:"Сообщения",class:"icon-arrow-left8 fs-4 me-3"},null,-1),vi=[ki],Ci={"data-bs-toggle":"modal","data-bs-target":"#user-data-modal"},yi={class:"fs-lg-6 fs-sm-7"},xi={"data-bs-toggle":"modal","data-bs-target":"#order-data-modal"},Si={class:"content-block simple"},Oi={id:"messages"},Ii={key:0,class:"date-block"},Mi={class:"date"},Ti={key:0,class:"attached-image"},$i=["href"],Pi=["src"],Ai={key:0,class:"message-row my-self"},Bi={class:"attached-image preview"},Di=["href"],Fi=["src"],Ri={key:0,class:"error"},Ni={class:"chat-input"},Ui={class:"chat-attach-file"},ji=o("i",{class:"icon-camera"},null,-1);function Ei(e,t,n,r,s,i){const _=m("UserPropertiesComponent"),u=m("ModalComponent"),f=m("OrderCarouselImagesComponent"),C=m("OrderPropertiesComponent"),b=m("UserNameComponent"),g=m("MessageComponent"),d=m("TextAreaComponent");return l(),c(v,null,[a(u,{id:"user-data-modal",head:"Данные пользователя"},{default:O(()=>[a(_,{user:s.myCompanion,use_rating:!0,allow_change_rating:!1},null,8,["user"]),mi,_i,o("p",hi,p(s.myCompanion.info_about?s.myCompanion.info_about:"Информация отсутствует"),1)]),_:1}),a(u,{id:"order-data-modal",head:"Данные о задаче"},{default:O(()=>[o("div",pi,[a(_,{user:s.chatOrder.user,use_rating:!0,allow_change_rating:!1},null,8,["user"]),a(f,{images:s.chatOrder.images},null,8,["images"]),a(C,{name:s.chatOrder.name,type:s.chatOrder.order_type.name,subtype:s.chatOrder.sub_type?s.chatOrder.sub_type.name:null,address:s.chatOrder.address,description_short:s.chatOrder.description_short},null,8,["name","type","subtype","address","description_short"])])]),_:1}),o("div",gi,[o("div",fi,[o("div",wi,[o("a",{href:n.chats_url},vi,8,bi),o("div",null,[o("a",Ci,[o("strong",null,[a(b,{user:s.myCompanion},null,8,["user"])])]),o("div",yi,[o("a",xi,"«"+p(s.chatOrder.name)+"» – "+p(s.chatOrder.order_type.name)+" от "+p(s.chatDate),1)])])]),o("div",Si,[o("div",Oi,[(l(!0),c(v,null,S(s.messages,(h,w)=>(l(),c("div",null,[i.newDate(w)?(l(),c("div",Ii,[o("span",Mi,p(i.getDate(h.created_at)),1)])):x("",!0),o("div",{class:B("message-row"+(h.user.id===s.userId?" my-self":""))},[h.image?(l(),c("div",Ti,[o("a",{href:"/"+h.image,class:"fancybox"},[o("img",{src:"/"+h.image},null,8,Pi)],8,$i),a(g,{message:h},null,8,["message"])])):(l(),I(g,{key:1,message:h},null,8,["message"]))],2)]))),256)),s.previewImage?(l(),c("div",Ai,[o("div",Bi,[o("i",{class:"icon-close2",onClick:t[0]||(t[0]=(...h)=>i.detachImage&&i.detachImage(...h))}),o("a",{href:s.previewImage,class:"fancybox"},[o("img",{src:s.previewImage},null,8,Fi)],8,Di),s.errors.image?(l(),c("div",Ri,p(s.errors.image),1)):x("",!0)])])):x("",!0)]),o("div",Ni,[o("div",Ui,[ji,o("input",{type:"file",name:"image",onChange:t[1]||(t[1]=(...h)=>i.attachingFile&&i.attachingFile(...h))},null,32)]),a(d,{id:"message",name:"message",icon:"icon-circle-right2",max:255,value:s.message,"onUpdate:value":t[2]||(t[2]=h=>s.message=h),error:s.errors.message,onIconClick:i.sendMessage,onKeydown:R(Y(i.sendMessage,["prevent","exact"]),["enter"]),onChange:t[3]||(t[3]=h=>s.errors.message=null)},null,8,["value","error","onIconClick","onKeydown"])])])])])],64)}const Li=y(ui,[["render",Ei]]),zi={name:"MyTicketsComponent",components:{ModalComponent:P,ModalPairButtonsComponent:J,InputComponent:N,InputImageComponent:W,TextAreaComponent:U,ButtonComponent:A,NoDataComponent:z,PaginatorComponent:V},created(){let e=this;this.userId=parseInt(this.user_id),this.getTickets(this.get_tickets_url),window.Echo.private("ticket_"+this.userId).listen(".ticket",t=>{if(t.notice==="new_item"||t.notice==="del_item")e.getTickets(e.get_tickets_url);else{let n=window.findSomething(e.tickets,t.ticket.id);n!==!1&&(e.tickets[n]=e.getTicketProps(t.ticket))}})},data(){return{userId:Number,tickets:[],links:[],subject:"",text:"",closingTicket:0,resumingTicket:0,disabledSubmit:!1,errors:{image:null,subject:null,text:null},tabs:{active:{name:"В работе",counter:0,tickets:Array,links:[]},closed:{name:"Закрыты",counter:0,tickets:Array,links:[]}}}},props:{user_id:String,def_image:String,my_tickets_url:String,get_tickets_url:String,new_ticket_url:String,close_ticket_url:String,resume_ticket_url:String},methods:{getTickets(e,t){let n=this;axios.get(e).then(function(r){n.tickets=[],$.each(r.data.tickets.data,function(s,i){n.tickets.push(n.getTicketProps(i))}),n.links=r.data.tickets.links,t&&t()}).catch(function(r){})},newTicket(){let e=this,t=new FormData,n=$("input[name=image]");this.disabledSubmit=!0,t.append("_token",window.tokenField),n.val()&&t.append("image",n[0].files[0]),t.append("subject",this.subject),t.append("text",this.text),axios.post(this.new_ticket_url,t).then(function(r){e.getTickets(e.get_tickets_url),$("#new-ticket-modal").modal("hide"),e.subject="",e.text="",$("img.image").attr("src",e.def_image),n.val(""),n.next("span.filename").html("Выберите файл"),window.showMessage(r.data.message),e.disabledSubmit=!1}).catch(function(r){$.each(r.response.data.errors,function(s,i){e.errors[s]=i[0]}),e.disabledSubmit=!1})},resumeTicketConfirm(e){this.resumingTicket=e,$("#ticket-resume-confirm-modal").modal("show")},closeTicketConfirm(e){this.closingTicket=e,$("#ticket-close-confirm-modal").modal("show")},closeTicket(){let e=this;axios.post(this.close_ticket_url,{_token:window.tokenField,ticket_id:this.closingTicket}).then(function(t){e.changeTicketStatus(1,e.closingTicket),window.showMessage(t.data.message),e.disabledSubmit=!1}).catch(function(t){$.each(t.response.data.errors,(n,r)=>{e.errors[n]=r[0],e.disabledSubmit=!1})})},resumeTicket(){let e=this;axios.post(this.resume_ticket_url,{_token:window.tokenField,ticket_id:this.resumingTicket}).then(function(t){e.changeTicketStatus(0,e.resumingTicket),window.showMessage(t.data.message)}).catch(function(t){})},changeTicketStatus(e,t){for(let n=0;n<this.tickets.length;n++)if(this.tickets[n].id===t){this.tickets[n].status=e;break}},cropContent(e,t){return window.cropContent(e,t)},changePage(e){let t=$("#my-tickets .without-tabs .row"),n=$(".paginator");n.fadeOut(),t.fadeOut(()=>{this.getTickets(e.url,()=>{t.fadeIn(),n.fadeIn()})})},getTicketProps(e){let t=0;for(let n=0;n<e.answers.length;n++)e.answers[n].read_owner||t++;return{id:e.id,status:e.status,subject:e.subject,created_at:e.created_at,answers:e.answers.length,new_answers:t}}}},Hi=o("h4",{class:"text-center"},"Вы действительно хотите закрыть этот запрос?",-1),Ki=o("h4",{class:"text-center"},"Вы действительно хотите возобновить этот запрос?",-1),Yi={class:"row"},Gi={class:"col-12 col-lg-9 col-md-8"},Vi={class:"col-12 col-lg-3 col-md-4 d-flex align-items-end pt-3"},Ji={class:"modal-footer justify-content-center mt-3"},Zi={id:"my-tickets",class:"col-12 col-lg-8 right-block"},qi={class:"rounded-block tall"},Qi={class:"d-flex flex-column flex-lg-row justify-content-between align-items-center"},Wi=o("div",{class:"d-flex align-items-center"},[o("h2",null,"Мои обращения в техподдержку")],-1),Xi={key:0,class:"h-100 without-tabs d-flex flex-column justify-content-between"},ea={class:"row pt-2"},ta={class:"item-in-list text-center"},na={class:"ticket-date"},sa=o("hr",null,null,-1),oa={class:"ticket-head"},ra=o("hr",null,null,-1),ia=o("hr",null,null,-1),aa={class:"ticket-messages-count"},la=o("br",null,null,-1),da=o("span",{class:"delimiter"},"|",-1),ca=o("hr",null,null,-1),ua={class:"w-100 d-flex justify-content-center"},ma=["href"];function _a(e,t,n,r,s,i){const _=m("ModalPairButtonsComponent"),u=m("ModalComponent"),f=m("InputComponent"),C=m("TextAreaComponent"),b=m("InputImageComponent"),g=m("ButtonComponent"),d=m("PaginatorComponent"),h=m("NoDataComponent");return l(),c(v,null,[a(u,{id:"ticket-close-confirm-modal",head:"Закрыть запрос"},{default:O(()=>[Hi,a(_,{onClickYes:i.closeTicket},null,8,["onClickYes"])]),_:1}),a(u,{id:"ticket-resume-confirm-modal",head:"Возобновить запрос"},{default:O(()=>[Ki,a(_,{onClickYes:i.resumeTicket},null,8,["onClickYes"])]),_:1}),a(u,{id:"new-ticket-modal",head:"Новое обращение в техподдержку"},{default:O(()=>[o("div",Yi,[o("div",Gi,[a(f,{label:"Тема обращения",type:"text",name:"subject",value:s.subject,"onUpdate:value":t[0]||(t[0]=w=>s.subject=w),error:s.errors.subject,onChange:t[1]||(t[1]=w=>s.errors.subject=null)},null,8,["value","error"]),a(C,{label:"Описание проблемы",name:"text",value:s.text,"onUpdate:value":t[2]||(t[2]=w=>s.text=w),error:s.errors.text,onChange:t[3]||(t[3]=w=>s.errors.text=null)},null,8,["value","error"])]),o("div",Vi,[a(b,{name:"image",placeholder_image:n.def_image,error:s.errors.image,onChange:t[4]||(t[4]=w=>s.errors.image=null)},null,8,["placeholder_image","error"])]),o("div",Ji,[a(g,{class:"btn btn-primary w-25 mt-3","data-bs-dismiss":"modal",text:"Закрыть"}),a(g,{class:"btn btn-primary w-25 mt-3",text:"Отправить",disabled:s.disabledSubmit,onClick:i.newTicket},null,8,["disabled","onClick"])])])]),_:1}),o("div",Zi,[o("div",qi,[o("div",Qi,[Wi,a(g,{class:"btn btn-primary",icon:"icon-new-tab2",text:"Создать обращение","data-bs-dismiss":"modal",target:"#new-ticket-modal"})]),s.tickets.length?(l(),c("div",Xi,[o("div",ea,[(l(!0),c(v,null,S(s.tickets,w=>(l(),c("div",{class:"col-lg-6 col-sm-12 ticket",key:w.id},[o("div",ta,[o("div",na,"Дата создания: "+p(new Date(w.created_at).toLocaleDateString("ru-RU")),1),sa,o("div",oa,"«"+p(i.cropContent(w.subject,40))+"»",1),ra,o("div",{class:B("status-label "+(w.status?"bg-success":"bg-danger"))},p(w.status?"Закрыто":"В работе"),3),ia,o("div",aa,[o("span",null,[M("Всего сообщений:"),o("b",null,p(w.answers),1)]),la,da,o("span",null,[M("Новых сообщений:"),o("b",null,p(w.new_answers),1)])]),ca,o("div",ua,[o("a",{class:"w-50 me-1",href:n.my_tickets_url+"?id="+w.id},[a(g,{class:"btn btn-primary w-100 m-auto",text:"Переписка"})],8,ma),w.status?(l(),I(g,{key:1,class:"btn btn-primary w-50 m-auto",text:"Возобновить",onClick:Z=>i.resumeTicketConfirm(w.id)},null,8,["onClick"])):(l(),I(g,{key:0,class:"btn btn-primary w-50 m-auto",text:"Закрыть запрос",onClick:Z=>i.closeTicketConfirm(w.id)},null,8,["onClick"]))])])]))),128))]),a(d,{links:s.links,tab_key:"tickets",onPaginate:i.changePage},null,8,["links","onPaginate"])])):(l(),I(h,{key:1}))])])],64)}const ha=y(zi,[["render",_a]]),pa={name:"AnswerComponent",components:{AvatarComponent:G,UserNameComponent:j},props:{answer:Object},methods:{getDate(e){return window.convertTime(e)}}},ga={class:"message"},fa={class:"author"};function wa(e,t,n,r,s,i){const _=m("AvatarComponent"),u=m("UserNameComponent");return l(),c(v,null,[a(_,{small:!0,avatar_image:n.answer.user.avatar,avatar_props:n.answer.user.avatar_props},null,8,["avatar_image","avatar_props"]),o("div",ga,[o("div",fa,[a(u,{user:n.answer.user},null,8,["user"]),o("span",null,p(i.getDate(n.answer.created_at)),1)]),o("div",null,p(n.answer.text),1)])],64)}const ba=y(pa,[["render",wa]]),ka={name:"TicketComponent",components:{ModalComponent:P,InputImageComponent:W,TextAreaComponent:U,ButtonComponent:A,AnswerComponent:ba},created(){let e=this;this.userId=parseInt(this.user_id),this.ticket=JSON.parse(this.incoming_ticket),this.answers=this.ticket.answers,this.answers.unshift({id:0,image:this.ticket.image,text:this.ticket.text,created_at:this.ticket.created_at,user:this.ticket.user}),window.bindFancybox(),e.scrollBottom(),window.Echo.private("ticket_"+this.userId).listen(".ticket",t=>{t.notice==="del_item"?window.location.href=this.back_url:e.answers[0]={image:t.ticket.image,text:t.ticket.text,user:t.ticket.user}}),window.Echo.private("answer_"+this.userId).listen(".answer",t=>{if(t.answer.ticket.id===e.ticket.id)if(t.notice==="new_item")e.answers.push(t.answer),t.answer.image&&window.bindFancybox(),e.scrollBottom();else if(t.notice==="edit_item"){let n=window.findSomething(e.answers,t.answer.id);e.answers[n]=t.answer}else{let n=window.findSomething(e.answers,t.answer.id);e.answers.splice(n,1)}})},data(){return{userId:Number,ticket:{image:null,subject:"",text:""},answers:[],text:"",disabledSubmit:!1,errors:{image:null,text:null}}},props:{user_id:String,def_image:String,incoming_ticket:String,new_answer_url:String,back_url:String},methods:{newAnswer(){let e=this,t=new FormData,n=$("input[name=image]");this.disabledSubmit=!0,t.append("_token",window.tokenField),t.append("ticket_id",this.ticket.id),n.val()&&t.append("image",n[0].files[0]),t.append("text",this.text),axios.post(this.new_answer_url,t).then(function(r){$("#new-answer-modal").modal("hide"),e.text="",$("img.image").attr("src",e.def_image),n.val(""),n.next("span.filename").html("Выберите файл"),window.showMessage(r.data.message),e.disabledSubmit=!1}).catch(function(r){$.each(r.response.data.errors,(s,i)=>{e.errors[s]=i[0]}),e.disabledSubmit=!1})},findAnswer(e){let t=!1;for(let n=0;n<this.answers.length;n++)if(this.answers[n].id===e){t=n;break}return t},cropContent(e,t){return window.cropContent(e,t)},scrollBottom(){setTimeout(()=>{window.scrollBottomMessages()},500)},bindLastFancyBox(){setTimeout(()=>{$("a.fancybox").last().fancybox(window.fancyBoxSettings)},300)}}},va={class:"row"},Ca={class:"col-12 col-lg-9 col-md-8"},ya={class:"col-12 col-lg-3 col-md-4 d-flex align-items-end pt-3"},xa={class:"modal-footer justify-content-center mt-3"},Sa={id:"ticket-answers",class:"col-12 col-lg-8 right-block"},Oa={class:"rounded-block tall pt-4"},Ia={class:"d-flex flex-column flex-lg-row justify-content-between align-items-center"},Ma={class:"d-flex align-items-center mb-3"},Ta=["href"],$a=o("i",{class:"icon-arrow-left52 nav-link p-0 fs-2 me-3"},null,-1),Pa=[$a],Aa={class:"mb-0"},Ba={class:"h-100 without-tabs d-flex flex-column justify-content-between"},Da={class:"content-block simple"},Fa={id:"messages",class:"answers"},Ra={class:"message-block"},Na={class:"w-25"},Ua=["href"],ja=["src"];function Ea(e,t,n,r,s,i){const _=m("TextAreaComponent"),u=m("InputImageComponent"),f=m("ButtonComponent"),C=m("ModalComponent"),b=m("AnswerComponent");return l(),c(v,null,[a(C,{id:"new-answer-modal",head:"Новый ответ на запрос «"+s.ticket.subject+"»"},{default:O(()=>[o("div",va,[o("div",Ca,[a(_,{label:"Ответ",name:"text",value:s.text,"onUpdate:value":t[0]||(t[0]=g=>s.text=g),error:s.errors.text,onChange:t[1]||(t[1]=g=>s.errors.text=null)},null,8,["value","error"])]),o("div",ya,[a(u,{name:"image",placeholder_image:n.def_image,error:s.errors.image,onChange:t[2]||(t[2]=g=>s.errors.image=null)},null,8,["placeholder_image","error"])]),o("div",xa,[a(f,{class:"btn btn-primary w-25 mt-3","data-bs-dismiss":"modal",text:"Закрыть"}),a(f,{class:"btn btn-primary w-25 mt-3",text:"Отправить",disabled:s.disabledSubmit,onClick:i.newAnswer},null,8,["disabled","onClick"])])])]),_:1},8,["head"]),o("div",Sa,[o("div",Oa,[o("div",Ia,[o("div",Ma,[o("a",{href:n.back_url},Pa,8,Ta),o("h2",Aa,p(i.cropContent(s.ticket.subject,55)),1)]),s.ticket.status?x("",!0):(l(),I(f,{key:0,class:"btn btn-primary mt-sm-3 mb-sm-3",icon:"icon-megaphone",text:"Написать ответ","data-bs-dismiss":"modal",target:"#new-answer-modal"}))]),o("div",Ba,[o("div",Da,[o("div",Fa,[(l(!0),c(v,null,S(s.answers,(g,d)=>(l(),c("div",null,[o("div",{class:B("message-row"+(g.user.id===s.userId?" my-self":""))},[o("div",Ra,[a(b,{answer:g},null,8,["answer"]),o("div",Na,[g.image?(l(),c("a",{key:0,href:"/"+g.image,class:"fancybox"},[o("img",{class:"w-100",src:"/"+g.image},null,8,ja)],8,Ua)):x("",!0)])])],2)]))),256))])])])])])],64)}const La=y(ka,[["render",Ea]]),ie=_e({components:{FeedbackComponent:ye,MessageComponent:Ie,TopLineComponent:tn,LeftMenuComponent:kn,AccountComponent:$n,MyOrdersListComponent:H,MyHelpListComponent:Ks,IncentivesComponent:xo,MySubscriptionsComponent:io,MyChatsComponent:$o,EditOrderComponent:ir,OrdersComponent:oi,ChatComponent:Li,MyTicketsComponent:ha,TicketComponent:La}});window.emitter=he();ie.config.globalProperties.emitter=window.emitter;ie.mount("#app");window.tokenField=$("input[name=_token]").val();window.phoneMask="+n(999)999-99-99";window.codeMask="99-99-99";window.phoneRegExp=/^((\+)?(\d)(\s)?(\()?[0-9]{3}(\))?(\s)?([0-9]{3})(\-)?([0-9]{2})(\-)?([0-9]{2}))$/gi;window.bornRegExp=/^([0-3][0-9])-([0-1][0-9])-((19([0-9][0-9]))|(20[0-9][0-9]))$/gi;window.emailRegExp=/^[a-zA-Z0-9][\-_\.\+\!\#\$\%\&\'\*\/\=\?\^\`\{\|]{0,1}([a-zA-Z0-9][\-_\.\+\!\#\$\%\&\'\*\/\=\?\^\`\{\|]{0,1})*[a-zA-Z0-9]@[a-zA-Z0-9][-\.]{0,1}([a-zA-Z][-\.]{0,1})*[a-zA-Z0-9]\.[a-zA-Z0-9]{1,}([\.\-]{0,1}[a-zA-Z]){0,}[a-zA-Z0-9]{0,}$/gi;window.codeRegExp=/^((\d){2}(\-)(\d){2}(\-)(\d){2})$/gi;window.toCamelize=e=>e.replace(/-|_./g,t=>t[1].toUpperCase());window.bellRinging=e=>{let t=0,n=15,r=setInterval(()=>{n*=-1,s(n),t++,t>5&&(clearInterval(r),s(0))},200);const s=i=>{e.css({"-webkit-transform":"rotate("+i+"deg)","-moz-transform":"rotate("+i+"deg)","-ms-transform":"rotate("+i+"deg)",transform:"rotate("+i+"deg)"})}};window.enablePointImagesCarousel=()=>{$(".images.owl-carousel").trigger("destroy.owl.carousel"),setTimeout(()=>{let e='<img src="/images/arrow_left.svg" />',t='<img src="/images/arrow_right.svg" />';$(".images.owl-carousel").owlCarousel({margin:10,loop:!0,nav:!1,autoplay:!0,autoplayTimeout:6e3,dots:!0,responsive:{0:{items:1}},navText:[e,t]})},200)};window.scrollBottomMessages=()=>{$("#messages").mCustomScrollbar("scrollTo","bottom")};window.changeTab=(e,t)=>{$("#tab-"+e).fadeOut(()=>{window.emitter.emit("tab-changed",t),$("#tab-"+t).fadeIn()})};$(document).ready(function(){$(".form-group.has-label i.icon-eye").click(function(){let e=$(this).parents(".form-group"),t=e.find("input");$(this).hasClass("icon-eye")?(t.attr("type","text"),$(this).removeClass("icon-eye").addClass("icon-eye-blocked")):(t.attr("type","password"),$(this).removeClass("icon-eye-blocked").addClass("icon-eye"))}),$(".dropdown-menu").mCustomScrollbar({axis:"y",theme:"light-3",alwaysShowScrollbar:1}),setTimeout(function(){removeLoader(),window.initImages(),window.bindFancybox()},500),$("#main-nav .navbar-toggler").click(function(){$(this).hasClass("collapsed")?$(this).find("span").css({"background-image":`url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%280, 0, 0, 0.55%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e")`,"background-size":"100%",opacity:1}):$(this).find("span").css({"background-image":`url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23000'%3e%3cpath d='M.293.293a1 1 0 011.414 0L8 6.586 14.293.293a1 1 0 111.414 1.414L9.414 8l6.293 6.293a1 1 0 01-1.414 1.414L8 9.414l-6.293 6.293a1 1 0 01-1.414-1.414L6.586 8 .293 1.707a1 1 0 010-1.414z'/%3e%3c/svg%3e")`,"background-size":"70%",opacity:.5})}),window.window.mapStepsInit(),$("#map").length&&(window.selectedPointsDie=$("#selected-points"),window.selectedPointsDie.mCustomScrollbar({axis:"y",theme:"light-3",alwaysShowScrollbar:0}),ymaps.ready(()=>{window.mapInit("map"),window.emitter.emit("map-is-ready")})),$("#messages").mCustomScrollbar({axis:"y",theme:"light-3",alwaysShowScrollbar:1,scrollTo:"bottom"})});
